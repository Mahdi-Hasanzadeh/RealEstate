function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/UserListings-C7qBdwyG.js","assets/index-Dq8bkDyD.js","assets/index-B3EqNP97.css","assets/PortConfig-CL2sLOPV.js","assets/Zoom-CI3qSSEj.js","assets/Wave-DQrlzeyQ.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{m as fe,n as xe,o as ae,p as M,q as R,t as T,v as re,r as i,w as ye,x as ve,j as e,y as Ce,z as je,_ as oe,S as ke,e as N,u as Se,c as be,d as Pe,a as we,i as u,F as K,A as De,B as S,T as L,f as W,I as Te,g as _e,h as v,b as q,L as Ue,D as $e,E as Ie,H as Le,J as Re,K as ze,M as Ae,k as G,O as H,P as Ee}from"./index-Dq8bkDyD.js";import{g as Fe,r as We,u as Me,a as Be}from"./index.esm2017-xdxYMBNT.js";import{a as Ve}from"./firebase-Dc1fJsNB.js";import{a as J,U as Q}from"./PortConfig-CL2sLOPV.js";import{C as Z}from"./Container-banvJYEF.js";import{V as Oe,a as Ne}from"./VisibilityOff-B-YPwfWb.js";import"./styled-BH6ihpp3.js";function Ke(s){return fe("MuiCircularProgress",s)}xe("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const qe=["className","color","disableShrink","size","style","thickness","value","variant"];let z=s=>s,X,Y,ee,se;const m=44,Ge=ae(X||(X=z`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),He=ae(Y||(Y=z`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),Je=s=>{const{classes:t,variant:n,color:l,disableShrink:o}=s,p={root:["root",n,`color${R(l)}`],svg:["svg"],circle:["circle",`circle${R(n)}`,o&&"circleDisableShrink"]};return je(p,Ke,t)},Qe=M("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:n}=s;return[t.root,t[n.variant],t[`color${R(n.color)}`]]}})(({ownerState:s,theme:t})=>T({display:"inline-block"},s.variant==="determinate"&&{transition:t.transitions.create("transform")},s.color!=="inherit"&&{color:(t.vars||t).palette[s.color].main}),({ownerState:s})=>s.variant==="indeterminate"&&re(ee||(ee=z`
      animation: ${0} 1.4s linear infinite;
    `),Ge)),Ze=M("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(s,t)=>t.svg})({display:"block"}),Xe=M("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(s,t)=>{const{ownerState:n}=s;return[t.circle,t[`circle${R(n.variant)}`],n.disableShrink&&t.circleDisableShrink]}})(({ownerState:s,theme:t})=>T({stroke:"currentColor"},s.variant==="determinate"&&{transition:t.transitions.create("stroke-dashoffset")},s.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:s})=>s.variant==="indeterminate"&&!s.disableShrink&&re(se||(se=z`
      animation: ${0} 1.4s ease-in-out infinite;
    `),He)),Ye=i.forwardRef(function(t,n){const l=ye({props:t,name:"MuiCircularProgress"}),{className:o,color:p="primary",disableShrink:d=!1,size:C=40,style:c,thickness:g=3.6,value:h=0,variant:_="indeterminate"}=l,j=ve(l,qe),f=T({},l,{color:p,disableShrink:d,size:C,thickness:g,value:h,variant:_}),k=Je(f),b={},x={},P={};if(_==="determinate"){const w=2*Math.PI*((m-g)/2);b.strokeDasharray=w.toFixed(3),P["aria-valuenow"]=Math.round(h),b.strokeDashoffset=`${((100-h)/100*w).toFixed(3)}px`,x.transform="rotate(-90deg)"}return e.jsx(Qe,T({className:Ce(k.root,o),style:T({width:C,height:C},x,c),ownerState:f,ref:n,role:"progressbar"},P,j,{children:e.jsx(Ze,{className:k.svg,ownerState:f,viewBox:`${m/2} ${m/2} ${m} ${m}`,children:e.jsx(Xe,{className:k.circle,style:b,ownerState:f,cx:m,cy:m,r:(m-g)/2,fill:"none",strokeWidth:g})})}))}),es=Ye,ss=i.lazy(()=>oe(()=>import("./UserListings-C7qBdwyG.js"),__vite__mapDeps([0,1,2,3,4]))),ts=i.lazy(()=>oe(()=>import("./Wave-DQrlzeyQ.js"),__vite__mapDeps([5,1,2]))),as=i.forwardRef(function(t,n){return e.jsx(ke,{direction:"up",ref:n,...t})}),te=3e3,us=()=>{const[s,t]=i.useState(!1),[n,l]=i.useState(!1),o=N(a=>a.persistData.user.userInfo),p=Se(),d=be(),C=Pe(),c=we(p.breakpoints.down("md")),g=i.useRef(null),[h,_]=i.useState(void 0),[j,f]=i.useState(0),[k,b]=i.useState(""),[x,P]=i.useState({}),[w,B]=i.useState(!1),ie=()=>{t(!s)},[ne,A]=i.useState(!1),E=N(a=>a.showListings.show),V=()=>{A(!0)},O=()=>{A(!1)},le=()=>{d(Ae(!E))},ce=()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("persist:root"),C("/signin"),d(G(!1)),d(H())},de=async()=>{try{const a=localStorage.getItem("accessToken");(await J.delete(`${Q}api/user/delete/${o.id}`,{headers:{Authorization:`Bearer ${a}`}})).data?(u.success("User deleted Successfully",{autoClose:3e3}),localStorage.removeItem("accessToken"),localStorage.removeItem("persist:root"),A(!1),C("/signup"),d(G(!1)),d(H())):u.error("user not deleted",{autoClose:3e3})}catch(a){u.error(a.message,{autoClose:3e3})}},ue=async a=>{var y,U,$,D;l(!0);try{const r=localStorage.getItem("accessToken");if(!(await J.put(`${Q}api/user/update/${o.id}`,{...x},{headers:{Authorization:`Bearer ${r}`}})).data)throw new Error("Update failed");d(Ee({...x})),u.success("Profile Updated Successfully",{autoClose:3e3}),f(0)}catch(r){u.error((y=r==null?void 0:r.response)==null?void 0:y.data.message,{autoClose:te}),($=(U=r==null?void 0:r.response)==null?void 0:U.data)!=null&&$.message?u.error((D=r==null?void 0:r.response)==null?void 0:D.data.message,{autoClose:3e3}):u.error(r.message,{autoClose:3e3})}finally{l(!1)}},F=a=>{P(y=>({...y,[a.target.name]:a.target.value}))},me=()=>{g.current.click()},pe=a=>{console.log(a.target.files[0]),_(a.target.files[0])};i.useEffect(()=>{h&&ge(h)},[h]);const ge=a=>{const y=Fe(Ve),U=new Date().getTime()+a.name,$=We(y,U),D=Me($,a);D.on("state_changed",r=>{l(!0);const I=r.bytesTransferred/r.totalBytes*100;f(I)},r=>{u.error(r.message,{autoClose:te}),b(r.message),l(!1)},()=>{Be(D.snapshot.ref).then(async r=>{P(I=>({...I,avatar:r})),l(!1)})})};function he(a){return e.jsxs(S,{sx:{position:"relative",display:"inline-flex"},children:[e.jsx(es,{variant:"determinate",...a}),e.jsx(S,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(L,{variant:"caption",component:"div",color:"text.secondary",children:`${Math.round(a.value)}%`})})]})}return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{maxWidth:"md",sx:{textAlign:"center",mt:5},children:[e.jsx(i.Suspense,{fallback:e.jsx(K,{}),children:e.jsx(ts,{title:"Profile"})}),e.jsx("input",{onChange:pe,type:"file",ref:g,hidden:!0,accept:"image/*"}),e.jsx("img",{onClick:me,src:x.avatar?x.avatar:o!=null&&o.avatar?o.avatar:De,title:o!=null&&o.username?o.username:"user image",style:{cursor:"pointer",width:"120px",objectFit:"cover",objectPosition:"center",borderRadius:50}}),e.jsx(S,{children:j>0&&j<100?e.jsxs(e.Fragment,{children:[e.jsx(L,{children:"Uploading ..."}),e.jsx(he,{value:j})]}):k?e.jsx(L,{variant:"body1",color:p.palette.error,children:k}):j===100&&e.jsx(L,{variant:"body1",color:p.palette.success,children:"Uploaded Successfully,Please press the update button to save changes"})}),e.jsxs(S,{component:"div",sx:{mx:"auto",mt:5,width:{xs:"99%",sm:"65%",md:"60%"},display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",flexWrap:"wrap",gap:2},children:[e.jsx(W,{type:"text",fullWidth:!0,size:c?"small":"medium",variant:"outlined",label:"Username",defaultValue:o.username,onChange:F,name:"username"}),e.jsx(W,{type:"email",fullWidth:!0,size:c?"small":"medium",variant:"outlined",label:"Email",defaultValue:o.email,onChange:F,name:"email"}),e.jsx(W,{type:s?"text":"password",fullWidth:!0,size:c?"small":"medium",variant:"outlined",label:"Password",defaultValue:"",onChange:F,name:"password",InputProps:{endAdornment:e.jsx(Te,{onClick:ie,children:e.jsx(_e,{position:"start",children:s?e.jsx(Oe,{fontSize:"small"}):e.jsx(Ne,{})})})}}),e.jsx(v,{fullWidth:!0,size:c?"small":"large",variant:"contained",sx:{backgroundColor:q,"&:hover":{opacity:.9,backgroundColor:q}},disabled:n,onClick:ue,children:n?"Loading...":"UPDATE"}),e.jsx(Ue,{style:{width:"100%"},className:"Link",to:"/create-list",children:e.jsx(v,{fullWidth:!0,size:c?"small":"large",variant:"contained",color:"success",children:"Create listing"})}),e.jsxs(S,{sx:{width:"100%",display:"flex",justifyContent:"space-between"},children:[e.jsx(v,{variant:"text",color:"warning",size:c?"small":"large",onClick:()=>{B(!1),V()},children:"Delete Account"}),e.jsx(v,{variant:"text",color:"warning",size:c?"small":"large",onClick:()=>{B(!0),V()},children:"Sign out"})]}),e.jsx(S,{display:"flex",justifyContent:"center",width:"100%",children:e.jsx(v,{onClick:le,variant:"text",type:"button",children:E?"Close listings":"Show Listings"})})]}),e.jsxs($e,{open:ne,TransitionComponent:as,keepMounted:!0,onClose:O,children:[e.jsx(Ie,{children:"Warning"}),e.jsx(Le,{children:e.jsx(Re,{children:w?"Are your to sign out from your account":"Are you sure to delete your account?"})}),e.jsxs(ze,{children:[e.jsx(v,{onClick:O,children:"Disagree"}),e.jsx(v,{onClick:()=>{w?ce():de()},children:"Agree"})]})]})]}),e.jsx(Z,{maxWidth:"lg",children:e.jsx(i.Suspense,{fallback:e.jsx(K,{}),children:E&&e.jsx(ss,{})})})]})};export{us as default};
