import{r as o,f as S,e as $,j as e,B as i,T as L,L as B,i as m,c as d,U as g,k as u,a3 as C}from"./index-DUCvUb60.js";import{C as k}from"./Container-DD0vJN8k.js";import{Z as b}from"./Zoom-CO5PsOnk.js";import"./styled-CKLzNqz5.js";const E=()=>{const[f,x]=o.useState(!1),[n,l]=o.useState(null),h=S(s=>s.persistData.user.userInfo),[a,c]=o.useState([]),p=$(),j=async()=>{x(!0);try{const s=await d.get(`${g}api/user/userInfo/${h.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(s.data.favorites.length==0){c([]),l(null);return}const t=s.data.favorites.join(",").toString(),r=await d.get(`${g}api/listing/favoriteListings?ListingsId=${t}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});c(r.data),l(null)}catch(s){l(s.message),u.error(s.message)}finally{x(!1)}},v=async s=>{var t;try{if(!(await d.put(`${g}api/user/update/${h.id}`,{favorites:s,removeFavorites:!0},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}})).data)throw new Error("Failed to remove from favorites");u.success("Removed from favorites"),c(a.filter(I=>I._id!=s))}catch(r){u.error(((t=r==null?void 0:r.response)==null?void 0:t.data.message)||r.message,{autoClose:3e3})}};o.useEffect(()=>{j()},[]);const y={maxWidth:400,width:400,heigth:400,display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"center",alignItems:"center",padding:2,backgroundColor:C,borderRadius:3,gap:1.5,flexWrap:{xs:"wrap",sm:"nowrap"}},w={width:"100%",height:"200px",objectPosition:"center",objectFit:"fill",borderRadius:"5px"},F={display:"flex",justifyContent:"center",alignItems:"center",columnGap:2,mt:2};return e.jsxs(k,{maxWidth:"xl",children:[e.jsx("h2",{style:{color:"green",textAlign:"center"},children:"Your Favorites"}),f?e.jsx("div",{children:e.jsx("h3",{children:"Loading..."})}):n!=null?e.jsx("div",{children:e.jsx("h3",{children:n})}):a.length==0?e.jsx("div",{children:e.jsx("h3",{children:"No Favorites"})}):a.length>0&&n==null&&e.jsx(i,{sx:{display:"flex",justifyContent:"center",gap:2,flexWrap:"wrap"},children:a.map((s,t)=>e.jsx(b,{in:!0,style:{transitionDelay:`${500+t*200}ms`},children:e.jsx(i,{className:"color",sx:y,children:e.jsxs(i,{children:[e.jsx(L,{variant:"body1",sx:{textAlign:"center",mb:1},children:s.name}),e.jsx(B,{style:{padding:0,margin:0},to:`/listing/${s._id}`,children:e.jsx("img",{className:"cardImage",srcSet:s.imageURLs[0],alt:s.name,style:w})}),e.jsxs(i,{sx:F,children:[e.jsx(m,{onClick:()=>{v(s._id)},variant:"outlined",color:"error",size:"small",children:"Delete from favorites"}),e.jsx(m,{onClick:()=>{p(`/listing/${s._id}`)},variant:"outlined",color:"primary",size:"small",children:"View Product"})]})]})})},t))})]})};export{E as default};
