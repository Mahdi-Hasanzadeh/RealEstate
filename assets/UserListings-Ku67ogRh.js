import{y as N,r as o,x as b,j as s,B as u,F as B,c as g,U as f,A as n}from"./index-EFlZ9WXB.js";import{N as E,d as T,I as U}from"./ItemCard-DrDoT0-F.js";import{L as D}from"./loader-DVeg3Acf.js";import{C as F}from"./ConfirmDialog-DoJlWq7S.js";import{C as _}from"./Container-CcpiWScL.js";import"./createSvgIcon-D4W3MDB3.js";import"./isMuiElement-BJt8Gr6u.js";import"./Card-DmdwVZOz.js";import"./CardMedia-P53nQfxt.js";import"./Zoom-D_6TWnSf.js";import"./styled-BbExtIJB.js";const i=3e3,K=()=>{const p=N(e=>e.persistData.user.userInfo),[c,m]=o.useState([]),[x,d]=o.useState(!0),[r,h]=o.useState({}),[C,l]=o.useState(!1),y=b(),j=()=>{l(!1)},L=()=>{S(r==null?void 0:r.id),l(!1)},$=async()=>{var e;try{d(!0);const t=await g.get(`${f}api/listing/${p.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(t.data.succeess===!1){n.error((e=t==null?void 0:t.data)==null?void 0:e.message,{autoClose:i});return}m(t.data)}catch(t){n.error(t.message,{autoClose:i})}finally{d(!1)}},S=async e=>{var t;try{const a=await g.delete(`${f}api/listing/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(a.data.success==!1){console.log(a.data.message),n.error((t=a==null?void 0:a.data)==null?void 0:t.message,{autoClose:i});return}n.error("Listing Deleted",{autoClose:i}),m(A=>A.filter(I=>I._id!==e))}catch(a){console.log(a.message),n.error(a.message,{autoClose:i})}},k=e=>{y(`/listing/update/${e==null?void 0:e._id},${e==null?void 0:e.mainCategoryName},${(e==null?void 0:e.subCategoryName)||null}`)};return o.useEffect(()=>{$()},[]),x?s.jsx(u,{sx:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"20%"},children:s.jsx(D,{})}):c.length===0?s.jsx(o.Suspense,{fallback:s.jsx(B,{}),children:s.jsx(E,{message:"No Listings",description:"You havenâ€™t created any listings yet.",icon:s.jsx(T,{sx:{fontSize:80,color:"grey.500",mb:2}})})}):s.jsxs(s.Fragment,{children:[s.jsxs(_,{maxWidth:"lg",children:[s.jsxs("h2",{style:{color:"green",textAlign:"center"},children:["Your Listings (",c.length,")"]}),s.jsx(u,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)",lg:"repeat(3, 1fr)"},gap:3,p:2,pb:10},children:c.map((e,t)=>s.jsx(U,{item:e,onDeleteClick:()=>{l(!0),h({id:e._id,name:e.name})},onEditClick:()=>k(e),showEdit:!0},t))})]}),s.jsx(F,{open:C,title:"Warning",message:`Are you sure to delete listing (${r==null?void 0:r.name})?`,onClose:j,onConfirm:L,cancelText:"Disagree",confirmText:"Agree"})]})};export{K as default};
