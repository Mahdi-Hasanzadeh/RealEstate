function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/UserListings-BxVhjOzo.js","assets/index-Cb8TbFW9.js","assets/index-B3EqNP97.css","assets/Zoom-DUT-4FZ9.js","assets/Wave-DA0j8wp3.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{n as ye,o as ve,p as oe,q as V,t as A,v as $,w as ie,r as i,x as Ce,y as je,j as e,z as ke,A as Se,_ as ne,S as we,f as Q,u as Pe,d as Te,e as _e,a as Ne,k as c,F as q,D as $e,B as P,T as N,g as M,I as Ie,h as Le,i as v,b as G,L as Re,E as ze,H as Me,J as Ae,K as Ee,M as Ue,O as We,l as H,P as J,c as Z,U as X,Q as Fe}from"./index-Cb8TbFW9.js";import{g as Ve,r as Be,u as De,a as Oe}from"./index.esm2017-xdxYMBNT.js";import{a as Ke}from"./firebase-Dc1fJsNB.js";import{C as Y}from"./Container-BeEU9-ET.js";import{V as Qe,a as qe}from"./VisibilityOff-BWjCdX85.js";import"./styled-CakSrLZw.js";function Ge(r){return ye("MuiCircularProgress",r)}ve("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const He=["className","color","disableShrink","size","style","thickness","value","variant"];let E=r=>r,ee,se,te,re;const h=44,Je=oe(ee||(ee=E`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),Ze=oe(se||(se=E`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),Xe=r=>{const{classes:a,variant:n,color:u,disableShrink:t}=r,p={root:["root",n,`color${A(u)}`],svg:["svg"],circle:["circle",`circle${A(n)}`,t&&"circleDisableShrink"]};return Se(p,Ge,a)},Ye=V("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(r,a)=>{const{ownerState:n}=r;return[a.root,a[n.variant],a[`color${A(n.color)}`]]}})(({ownerState:r,theme:a})=>$({display:"inline-block"},r.variant==="determinate"&&{transition:a.transitions.create("transform")},r.color!=="inherit"&&{color:(a.vars||a).palette[r.color].main}),({ownerState:r})=>r.variant==="indeterminate"&&ie(te||(te=E`
      animation: ${0} 1.4s linear infinite;
    `),Je)),es=V("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(r,a)=>a.svg})({display:"block"}),ss=V("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(r,a)=>{const{ownerState:n}=r;return[a.circle,a[`circle${A(n.variant)}`],n.disableShrink&&a.circleDisableShrink]}})(({ownerState:r,theme:a})=>$({stroke:"currentColor"},r.variant==="determinate"&&{transition:a.transitions.create("stroke-dashoffset")},r.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:r})=>r.variant==="indeterminate"&&!r.disableShrink&&ie(re||(re=E`
      animation: ${0} 1.4s ease-in-out infinite;
    `),Ze)),ts=i.forwardRef(function(a,n){const u=Ce({props:a,name:"MuiCircularProgress"}),{className:t,color:p="primary",disableShrink:g=!1,size:C=40,style:d,thickness:x=3.6,value:f=0,variant:I="indeterminate"}=u,j=je(u,He),b=$({},u,{color:p,disableShrink:g,size:C,thickness:x,value:f,variant:I}),k=Xe(b),T={},s={},S={};if(I==="determinate"){const w=2*Math.PI*((h-x)/2);T.strokeDasharray=w.toFixed(3),S["aria-valuenow"]=Math.round(f),T.strokeDashoffset=`${((100-f)/100*w).toFixed(3)}px`,s.transform="rotate(-90deg)"}return e.jsx(Ye,$({className:ke(k.root,t),style:$({width:C,height:C},s,d),ownerState:b,ref:n,role:"progressbar"},S,j,{children:e.jsx(es,{className:k.svg,ownerState:b,viewBox:`${h/2} ${h/2} ${h} ${h}`,children:e.jsx(ss,{className:k.circle,style:T,ownerState:b,cx:h,cy:h,r:(h-x)/2,fill:"none",strokeWidth:x})})}))}),rs=ts,as=i.lazy(()=>ne(()=>import("./UserListings-BxVhjOzo.js"),__vite__mapDeps([0,1,2,3]))),os=i.lazy(()=>ne(()=>import("./Wave-DA0j8wp3.js"),__vite__mapDeps([4,1,2]))),is=i.forwardRef(function(a,n){return e.jsx(we,{direction:"up",ref:n,...a})}),ae=3e3,hs=()=>{const[r,a]=i.useState(!1),[n,u]=i.useState(!1),t=Q(o=>o.persistData.user.userInfo),p=Pe(),g=Te(),C=_e(),d=Ne(p.breakpoints.down("md")),x=i.useRef(null),[f,I]=i.useState(void 0),[j,b]=i.useState(0),[k,T]=i.useState(""),[s,S]=i.useState(t),[w,U]=i.useState(""),[B,D]=i.useState(!1),le=()=>{a(!r)},[ce,W]=i.useState(!1),F=Q(o=>o.showListings.show),O=()=>{W(!0)},K=()=>{W(!1)},ue=()=>{g(We(!F))},de=()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("persist:root"),C("/signin"),g(H(!1)),g(J())},me=async()=>{try{const o=localStorage.getItem("accessToken");(await Z.delete(`${X}api/user/delete/${t.id}`,{headers:{Authorization:`Bearer ${o}`}})).data?(c.success("User deleted Successfully",{autoClose:3e3}),localStorage.removeItem("accessToken"),localStorage.removeItem("persist:root"),W(!1),C("/signup"),g(H(!1)),g(J())):c.error("user not deleted",{autoClose:3e3})}catch(o){c.error(o.message,{autoClose:3e3})}},ge=async o=>{var R,z,_,m;if(t.username==(s==null?void 0:s.username)&&t.email==(s==null?void 0:s.email)&&t.mobileNumber==(s==null?void 0:s.mobileNumber)&&t.avatar==(s==null?void 0:s.avatar)&&t.password==(s==null?void 0:s.password)){c.info("No changes detected");return}if(!(s!=null&&s.username)||!(s!=null&&s.email)){c.error("Username or email is empty");return}if(!/^\d+$/.test(s==null?void 0:s.mobileNumber)){c.error("Telephone number Should Contain only numbers"),U("Telephone number Should Contain only numbers");return}if((s==null?void 0:s.mobileNumber.length)<10||(s==null?void 0:s.mobileNumber.length)>10){c.error("Mobile number should be 10 digits"),U("Mobile number should be 10 digits");return}try{if(u(!0),!(await Z.put(`${X}api/user/update/${t.id}`,{...s},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}})).data)throw new Error("Update failed");const{password:ns,...be}=s;g(Fe({...be})),c.success("Profile Updated Successfully",{autoClose:3e3}),b(0)}catch(l){c.error((R=l==null?void 0:l.response)==null?void 0:R.data.message,{autoClose:ae}),(_=(z=l==null?void 0:l.response)==null?void 0:z.data)!=null&&_.message?c.error((m=l==null?void 0:l.response)==null?void 0:m.data.message,{autoClose:3e3}):c.error(l.message,{autoClose:3e3})}finally{U(""),u(!1)}},L=o=>{o.target.name=="password"?S(y=>({...y,password:o.target.value==""?t.password:o.target.value})):S(y=>({...y,[o.target.name]:o.target.value}))},he=()=>{x.current.click()},pe=o=>{console.log(o.target.files[0]),I(o.target.files[0])};i.useEffect(()=>{f&&xe(f)},[f]);const xe=o=>{const y=Ve(Ke),R=new Date().getTime()+o.name,z=Be(y,R),_=De(z,o);_.on("state_changed",m=>{u(!0);const l=m.bytesTransferred/m.totalBytes*100;b(l)},m=>{c.error(m.message,{autoClose:ae}),T(m.message),u(!1)},()=>{Oe(_.snapshot.ref).then(async m=>{S(l=>({...l,avatar:m})),u(!1)})})};function fe(o){return e.jsxs(P,{sx:{position:"relative",display:"inline-flex"},children:[e.jsx(rs,{variant:"determinate",...o}),e.jsx(P,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(N,{variant:"caption",component:"div",color:"text.secondary",children:`${Math.round(o.value)}%`})})]})}return e.jsxs(e.Fragment,{children:[e.jsxs(Y,{maxWidth:"md",sx:{textAlign:"center",mt:5},children:[e.jsx(i.Suspense,{fallback:e.jsx(q,{}),children:e.jsx(os,{title:"Profile"})}),e.jsx("input",{onChange:pe,type:"file",ref:x,hidden:!0,accept:"image/*"}),e.jsx("img",{onClick:he,src:s.avatar?s.avatar:t!=null&&t.avatar?t.avatar:$e,title:t!=null&&t.username?t.username:"user image",style:{cursor:"pointer",width:"120px",objectFit:"cover",objectPosition:"center",borderRadius:50}}),e.jsx(P,{children:j>0&&j<100?e.jsxs(e.Fragment,{children:[e.jsx(N,{children:"Uploading ..."}),e.jsx(fe,{value:j})]}):k?e.jsx(N,{variant:"body1",color:p.palette.error,children:k}):j===100&&e.jsx(N,{variant:"body1",color:p.palette.success,children:"Uploaded Successfully,Please press the update button to save changes"})}),e.jsxs(P,{component:"div",sx:{mx:"auto",mt:5,width:{xs:"99%",sm:"65%",md:"60%"},display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",flexWrap:"wrap",gap:2},children:[e.jsx(M,{type:"text",fullWidth:!0,size:d?"small":"medium",variant:"outlined",label:"Username",defaultValue:t.username,onChange:L,name:"username"}),e.jsx(M,{type:"email",fullWidth:!0,size:d?"small":"medium",variant:"outlined",label:"Email",defaultValue:t.email,onChange:L,name:"email"}),e.jsx(M,{type:r?"text":"password",fullWidth:!0,size:d?"small":"medium",variant:"outlined",label:"Password",defaultValue:"",onChange:L,name:"password",InputProps:{endAdornment:e.jsx(Ie,{onClick:le,children:e.jsx(Le,{position:"start",children:r?e.jsx(Qe,{fontSize:"small"}):e.jsx(qe,{})})})}}),!(t!=null&&t.mobileNumber)&&e.jsx(N,{sx:{color:"red"},children:"Please Add your mobile number"}),e.jsx(M,{error:!!w,type:"text",fullWidth:!0,size:d?"small":"medium",variant:"outlined",label:"Mobile Number",defaultValue:(t==null?void 0:t.mobileNumber)||"",onChange:L,name:"mobileNumber",helperText:w||null}),e.jsx(v,{fullWidth:!0,size:d?"small":"large",variant:"contained",sx:{backgroundColor:G,"&:hover":{opacity:.9,backgroundColor:G}},disabled:n,onClick:ge,children:n?"Loading...":"UPDATE"}),e.jsx(Re,{style:{width:"100%"},className:"Link",to:"/create-list",children:e.jsx(v,{fullWidth:!0,size:d?"small":"large",variant:"contained",color:"success",children:"Create listing"})}),e.jsxs(P,{sx:{width:"100%",display:"flex",justifyContent:"space-between"},children:[e.jsx(v,{variant:"text",color:"warning",size:d?"small":"large",onClick:()=>{D(!1),O()},children:"Delete Account"}),e.jsx(v,{variant:"text",color:"warning",size:d?"small":"large",onClick:()=>{D(!0),O()},children:"Sign out"})]}),e.jsx(P,{display:"flex",justifyContent:"center",width:"100%",children:e.jsx(v,{onClick:ue,variant:"text",type:"button",children:F?"Close listings":"Show Listings"})})]}),e.jsxs(ze,{open:ce,TransitionComponent:is,keepMounted:!0,onClose:K,children:[e.jsx(Me,{children:"Warning"}),e.jsx(Ae,{children:e.jsx(Ee,{children:B?"Are your to sign out from your account":"Are you sure to delete your account?"})}),e.jsxs(Ue,{children:[e.jsx(v,{onClick:K,children:"Disagree"}),e.jsx(v,{onClick:()=>{B?de():me()},children:"Agree"})]})]})]}),e.jsx(Y,{maxWidth:"lg",children:e.jsx(i.Suspense,{fallback:e.jsx(q,{}),children:F&&e.jsx(as,{})})})]})};export{hs as default};
