function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/Wave-DQrlzeyQ.js","assets/index-Dq8bkDyD.js","assets/index-B3EqNP97.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{r as f,_ as S,d as _,u as A,a as E,j as e,F as q,B as c,f as u,b as G,V as N,h as C,i as m}from"./index-Dq8bkDyD.js";import{g as O,r as $,u as M,a as V}from"./index.esm2017-xdxYMBNT.js";import{a as Y}from"./firebase-Dc1fJsNB.js";import{a as H,U as K}from"./PortConfig-CL2sLOPV.js";import{C as Q}from"./Container-banvJYEF.js";import{G as P,F as p,C as h}from"./Grid-ByqYa3nk.js";import"./styled-BH6ihpp3.js";const J=f.lazy(()=>S(()=>import("./Wave-DQrlzeyQ.js"),__vite__mapDeps([0,1,2]))),d=3e3,re=()=>{const U=_(),[x,z]=f.useState([]),[v,y]=f.useState(),[b,g]=f.useState(!1),L=A(),t=E(L.breakpoints.down("md")),[s,j]=f.useState({type:"rent",description:"",imageURLs:[],parking:!1,furnished:!1,offer:!1,bedrooms:1,bath:1,regularPrice:1,discountPrice:1}),w=async a=>{var o;if(a.preventDefault(),!s.name||!s.description||!s.address||s.imageURLs.length===0){console.log("Fill out the form"),m.error("Please fill out the form",{autoClose:d});return}if(parseInt(s.discountPrice)>=parseInt(s.regularPrice)){m.error("Discount price can not be bigger than or equal to regular price",{autoClose:d});return}const l=localStorage.getItem("accessToken");try{g(!0);const r=await H.post(`${K}api/listing/create`,{...s,discountPrice:s.offer?s.discountPrice:0},{headers:{Authorization:`Bearer ${l}`}});if(((o=r==null?void 0:r.data)==null?void 0:o.succeess)==!1){console.log(r.data.message),m.error(r.data.message,{autoClose:d}),y(r.data.message);return}m.success("Your listing created successfully"),U(`/listing/${r.data._id}`)}catch(r){console.log(r.message),m.error(r.message,{autoClose:d})}finally{g(!1)}},F=a=>{j(l=>({...l,imageURLs:[...s.imageURLs.filter(o=>o!==a)]}))},n=a=>{a.target.name=="parking"||a.target.name=="furnished"||a.target.name=="offer"?j(l=>({...l,[a.target.name]:a.target.name=="parking"?!s.parking:a.target.name=="furnished"?!s.furnished:!s.offer})):j(l=>({...l,[a.target.name]:(a.target.type=="text",a.target.value)}))},D=a=>{a.target.files.length<7&&z(a.target.files)},I=()=>{if(x.length>0&&x.length+s.imageURLs.length<7){const l=[];console.log("upload photo"),g(!0);for(var a=0;a<x.length;a++)l.push(T(x[a]));Promise.all(l).then(o=>{j(r=>({...r,imageURLs:s.imageURLs.concat(o)})),g(!0)}).then(()=>{y(!1)}).catch(o=>{m.error("image Upload failed.Image should be 2mb ",{autoClose:d}),console.log(o.message)}).finally(()=>{g(!1)})}else y("Please choose only six images for every list"),m.error("Please choose only six images for every list",{autoClose:d})},T=async a=>new Promise((l,o)=>{const r=O(Y),W=a.name+new Date().getTime(),B=$(r,W),k=M(B,a);k.on("state_changed",i=>{const R=i.bytesTransferred/i.totalBytes*100;console.log(R),console.log("Upload is "+Math.round(R)+"% done")},i=>{console.log("eroro upload"),m.error(i.message,{autoClose:d}),console.log(i),g(!1),o(i)},()=>{console.log("down url"),V(k.snapshot.ref).then(i=>{l(i),console.log(i)})})});return e.jsx(e.Fragment,{children:e.jsxs(Q,{maxWidth:"md",sx:{position:"relative",top:50,mb:20},children:[e.jsx(f.Suspense,{fallback:e.jsx(q,{}),children:e.jsx(J,{title:"Create list"})}),e.jsxs(P,{container:!0,spacing:t?0:1,justifyContent:t?"normal":"flex-start",children:[e.jsx(P,{item:!0,xs:10,md:6,children:e.jsxs(c,{component:"form",sx:{padding:2},children:[e.jsxs(c,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[e.jsx(u,{fullWidth:!0,type:"text",label:"Name",variant:"outlined",name:"name",value:s.name||"",onChange:n,required:!0,size:t?"small":"medium"}),e.jsx(u,{multiline:!0,fullWidth:!0,maxRows:2,type:"text",label:"Description",variant:"outlined",name:"description",value:s.description,onChange:n,required:!0,size:t?"small":"medium"}),e.jsx(u,{fullWidth:!0,type:"text",label:"address",variant:"outlined",name:"address",value:(s==null?void 0:s.address)||"",onChange:n,required:!0,size:t?"small":"medium"})]}),e.jsxs(c,{sx:{display:"flex",justifyContent:{xs:"space-between",sm:"flex-start"}},children:[e.jsx(p,{value:"sell",label:"Sell",labelPlacement:"start",name:"type",onChange:n,control:e.jsx(h,{size:t?"small":"medium",checked:s.type==="sell"})}),e.jsx(p,{value:"rent",label:"Rent",labelPlacement:"start",name:"type",onChange:n,control:e.jsx(h,{size:t?"small":"medium",checked:s.type==="rent"})})]}),e.jsxs(c,{sx:{display:"flex",flexWrap:"wrap",flexDirection:{xs:"column",sm:"row"},alignItems:"flex-start",mb:1.5},children:[e.jsx(p,{value:!0,label:"Parking spot",labelPlacement:"start",name:"parking",onChange:n,control:e.jsx(h,{size:t?"small":"medium",checked:s.parking||!1})}),e.jsx(p,{value:!0,label:"Furnished",labelPlacement:"start",name:"furnished",onChange:n,control:e.jsx(h,{size:t?"small":"medium",checked:s.furnished||!1})}),e.jsx(p,{value:!0,label:"Offer",labelPlacement:"start",name:"offer",onChange:n,control:e.jsx(h,{size:t?"small":"medium",checked:s.offer||!1})})]}),e.jsxs(c,{sx:{display:"flex",justifyContent:"flex-start",gap:3,flexWrap:"wrap"},children:[e.jsx(u,{type:"number",label:"Beds",size:t?"small":"medium",name:"bedrooms",value:s.bedrooms,onChange:n}),e.jsx(u,{type:"number",label:"Baths",size:t?"small":"medium",name:"bath",value:s.bath,onChange:n}),e.jsx(u,{type:"number",label:"Regular Price / month",size:t?"small":"medium",name:"regularPrice",value:s.regularPrice,onChange:n}),s.offer&&e.jsx(u,{type:"number",label:"Discount Price / month",size:t?"small":"medium",name:"discountPrice",value:s.discountPrice,onChange:n})]})]})}),e.jsxs(P,{item:!0,xs:10,md:6,sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs(c,{children:[e.jsxs("h3",{style:{fontSize:t?"16.5px":"20px",fontWeight:"bolder",textAlign:"justify"},children:["Images:",e.jsx("span",{style:{color:G},children:"The first image will be the cover (maximum:6)"})]}),e.jsxs(c,{sx:{display:"flex",justifyContent:"flex-start",flexWrap:"wrap",gap:1.5},children:[e.jsx("input",{style:{border:"1p solid aqua",outline:"2px solid",outlineColor:N,textIndent:"4px"},type:"file",accept:"image/*",multiple:!0,onChange:D}),e.jsx(C,{onClick:I,variant:"contained",color:"success",size:t?"small":"large",disabled:b,fullWidth:!0,children:b?"Uploading....":"UPLOAD"})]})]}),e.jsxs(c,{className:"show image section",children:[e.jsx("p",{children:v&&v}),s.imageURLs.length>0&&s.imageURLs.map((a,l)=>e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx("img",{width:"100",height:"100",style:{borderRadius:"5px",objectFit:"cotain"},src:a,alt:a}),e.jsx(C,{onClick:()=>{F(a)},variant:"text",color:"warning",children:"Delete"})]},l))]}),e.jsx(C,{sx:{},type:"submit",onClick:w,variant:"contained",fullWidth:!0,size:t?"small":"large",color:"success",disabled:!!b,children:b?"Loading":"Create list"})]})]})]})})};export{re as default};
