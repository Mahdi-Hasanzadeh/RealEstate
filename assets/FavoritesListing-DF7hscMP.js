import{r as o,f as I,e as S,j as s,B as n,T as C,L,i as f,c as d,U as g,k as u,a3 as B}from"./index-BqzxYTW2.js";import{C as b}from"./Container-BLvXd5GS.js";import{Z as k}from"./Zoom-BmAGhfZP.js";import"./styled-B4FQNqCM.js";const z=()=>{const[p,x]=o.useState(!1),[i,l]=o.useState(null),h=I(e=>e.persistData.user.userInfo),[a,c]=o.useState([]),m=S(),j=async()=>{x(!0);try{const e=await d.get(`${g}api/user/userInfo/${h.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(e.data.favorites.length==0){c([]),l(null);return}const r=e.data.favorites.join(",").toString(),t=await d.get(`${g}api/listing/favoriteListings?ListingsId=${r}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});c(t.data),l(null)}catch(e){l(e.message),u.error(e.message)}finally{x(!1)}},v=async e=>{var r;try{if(!(await d.put(`${g}api/user/update/${h.id}`,{favorites:e,removeFavorites:!0},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}})).data)throw new Error("Failed to remove from favorites");u.success("Removed from favorites"),c(a.filter(F=>F._id!=e))}catch(t){u.error(((r=t==null?void 0:t.response)==null?void 0:r.data.message)||t.message,{autoClose:3e3})}};o.useEffect(()=>{j()},[]);const y={maxWidth:400,width:400,heigth:400,display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"center",alignItems:"center",padding:2,backgroundColor:B,borderRadius:3,gap:1.5,flexWrap:{xs:"wrap",sm:"nowrap"}},$={width:"100%",height:"200px",objectPosition:"center",objectFit:"fill",borderRadius:"5px"},w={display:"flex",justifyContent:"center",alignItems:"center",columnGap:2,mt:2};return s.jsxs(b,{maxWidth:"xl",children:[s.jsx("h2",{style:{color:"green",textAlign:"center"},children:"Your Favorites"}),p?s.jsx("div",{children:s.jsx("h3",{children:"Loading..."})}):i!=null?s.jsx("div",{children:s.jsx("h3",{children:i})}):a.length==0?s.jsx("div",{children:s.jsx("h3",{children:"No Favorites"})}):a.length>0&&i==null&&s.jsx(n,{sx:{display:"flex",justifyContent:"center",gap:2,flexWrap:"wrap"},children:a.map((e,r)=>s.jsx(k,{in:!0,style:{transitionDelay:`${500+r*200}ms`},children:s.jsx(n,{className:"color",sx:y,children:s.jsxs(n,{children:[s.jsx(C,{variant:"body1",sx:{textAlign:"center",mb:1},children:e.name}),s.jsx(L,{style:{padding:0,margin:0},to:`/listing/${e==null?void 0:e._id},${e==null?void 0:e.mainCategoryName},${(e==null?void 0:e.subCategoryName)||null}`,children:s.jsx("img",{className:"cardImage",srcSet:e.imageURLs[0],alt:e.name,style:$})}),s.jsxs(n,{sx:w,children:[s.jsx(f,{onClick:()=>{v(e._id)},variant:"outlined",color:"error",size:"small",children:"Delete from favorites"}),s.jsx(f,{onClick:()=>{m(`/listing/${e._id}`)},variant:"outlined",color:"primary",size:"small",children:"View Product"})]})]})})},r))})]})};export{z as default};
