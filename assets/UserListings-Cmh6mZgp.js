import{j as a,a7 as $,a8 as k,a9 as A,aa as E,ab as w,a as b,z as I,r as n,y as B,F as L,B as U,c as D,v as p,d as z,f as O,g as W}from"./index-B6Jh5Kqf.js";import{N as Y,d as Z,I as q}from"./ItemCard-B4y_lpWM.js";import{Z as G}from"./Zoom-BGt3lVFV.js";import{F as P,a as H}from"./FormLabel-BWInThNm.js";import{R as J,a as x}from"./RadioGroup-CJEdl4IK.js";import{F as g}from"./FormControlLabel-Cgyp2Sx4.js";import{C as K}from"./Container-Dhm7lGM3.js";import"./SearchOff-DCa9dXma.js";import"./Card-BH7gk7ep.js";import"./CardMedia-Cgk7daUN.js";import"./useFormControl-CrCWuu7o.js";import"./SwitchBase-K1iBrzst.js";import"./Stack-DzziobC3.js";import"./styled-lc6bJm8w.js";const M=({open:h,title:o="Confirm",message:d="Are you sure?",onClose:m,onConfirm:u,cancelText:t="Cancel",confirmText:j="Confirm",reason:f,setReason:l})=>a.jsxs($,{open:h,TransitionComponent:G,onClose:m,disableRestoreFocus:!0,children:[a.jsx(k,{id:"confirm-dialog-title",children:o}),a.jsxs(A,{children:[a.jsx(E,{id:"confirm-dialog-description",children:d}),a.jsxs(P,{component:"fieldset",sx:{mt:2},children:[a.jsx(H,{component:"legend",children:"Reason for deleting"}),a.jsxs(J,{value:f,onChange:i=>l(i.target.value),children:[a.jsx(g,{value:"sold",control:a.jsx(x,{}),label:"The product has been sold"}),a.jsx(g,{value:"no_longer_selling",control:a.jsx(x,{}),label:"I no longer want to sell it"}),a.jsx(g,{value:"incorrect_info",control:a.jsx(x,{}),label:"The listing information is incorrect"}),a.jsx(g,{value:"other",control:a.jsx(x,{}),label:"Other reason"})]})]})]}),a.jsxs(w,{children:[a.jsx(b,{onClick:m,children:t}),a.jsx(b,{onClick:u,autoFocus:!0,disabled:!f,children:j})]})]}),me=()=>{const h=I(e=>e.persistData.user.userInfo),[o,d]=n.useState([]),[m,u]=n.useState(!0),[t,j]=n.useState({}),[f,l]=n.useState(!1),i=B(),[y,F]=n.useState(""),N=()=>{l(!1)},v=()=>{R(t==null?void 0:t.id),l(!1)},_=async()=>{var e;try{u(!0);const s=await D.get(`api/listing/${h.id}`);if(s.data.succeess===!1){p.error((e=s==null?void 0:s.data)==null?void 0:e.message);return}d(s.data)}catch(s){p.error(s.message)}finally{u(!1)}},R=async e=>{var s,c;try{const r=o.filter(C=>C._id==e)[0];await D.delete(`api/listing/${e}`,{data:{mainCategoryName:r.mainCategoryName,subCategoryName:r.subCategoryName,reason:y}}),p.success("Listing Deleted Successfully");const T=o.filter(C=>C._id!=e);d(T)}catch(r){p.error(((c=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:c.message)||r.message)}},S=e=>{const s=e==null?void 0:e.mainCategoryName,c=e==null?void 0:e.subCategoryName;s.toLowerCase()=="estate"?i(`/listing/update/${e==null?void 0:e._id},${e==null?void 0:e.mainCategoryName}`):s==z&&(c==O?i(`/cellphone/update/${e==null?void 0:e._id}`):c==W&&i(`/computer/update/${e==null?void 0:e._id}`))};return n.useEffect(()=>{_()},[]),m?a.jsx(L,{}):o.length===0?a.jsx(n.Suspense,{fallback:a.jsx(L,{}),children:a.jsx(Y,{message:"No Listings",description:"You havenâ€™t created any listings yet.",icon:a.jsx(Z,{sx:{fontSize:80,color:"grey.500",mb:2}})})}):a.jsxs(a.Fragment,{children:[a.jsxs(K,{maxWidth:"lg",children:[a.jsxs("h2",{style:{color:"green",textAlign:"center"},children:["Your Listings (",o.length,")"]}),a.jsx(U,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)",lg:"repeat(3, 1fr)"},gap:3,p:2,pb:10},children:o.map((e,s)=>a.jsx(q,{item:e,onDeleteClick:()=>{l(!0),j({id:e._id,name:e.name})},onEditClick:()=>S(e),showEdit:!0},s))})]}),a.jsx(M,{open:f,title:"Warning",message:`Are you sure to delete listing (${t==null?void 0:t.name})?`,onClose:N,onConfirm:v,cancelText:"Disagree",confirmText:"Agree",reason:y,setReason:F})]})};export{me as default};
