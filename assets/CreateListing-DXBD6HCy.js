function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/WaveHeader-Dmy_mXmt.js","assets/index-Gdgiy31r.js","assets/index-DDnostVl.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{r as u,_ as pe,y as be,x as je,u as Ce,b as ye,z as ve,e as B,am as O,S as G,an as q,Q as $,ad as Y,a0 as Q,$ as H,d as k,f as V,j as e,F as Re,T as c,Z as Pe,B as Se,ah as Ie,ao as Me,ai as ke,g as Z,a as T,v as n,ap as Ne,aq as we,M as Ae,c as J}from"./index-Gdgiy31r.js";import{d as y}from"./ExpandMore-hTfIHko4.js";import{g as De,r as Fe,u as Le,a as Ve}from"./index.esm2017-C0yvW6Ps.js";import{a as We}from"./firebase-ZV_pIUqm.js";import h from"./ComboBox-DY6BI4Zs.js";import{C as Ue}from"./Container-B-YhSeda.js";import{G as t}from"./Grid-C1tGcqte.js";import{A as v,a as R,b as P}from"./AccordionSummary-FQXESMnG.js";import{T as f}from"./TextField-DUVLAStq.js";import{R as Be,a as K,F as Te}from"./RadioGroup-CATN1o56.js";import{F as N}from"./FormControlLabel-DN-7-GHv.js";import{C as z}from"./Checkbox-CTEmPxIF.js";import"./MenuItem-BZBtx8m7.js";import"./List-Cm2n5Tow.js";import"./dividerClasses-FdZkGMiS.js";import"./listItemTextClasses-Clm-YAH0.js";import"./styled-CnSCcvPH.js";import"./react-is.production.min-DUDD-a5e.js";import"./Collapse-UvN0k-bW.js";import"./FormLabel-1GwVSSAr.js";import"./useFormControl-oBrz1Bno.js";import"./SwitchBase-Df7wtRlh.js";import"./Stack-aLlAwLr-.js";u.lazy(()=>pe(()=>import("./WaveHeader-Dmy_mXmt.js"),__vite__mapDeps([0,1,2])));const ua=()=>{const X=be(),ee=je(),[w,ae]=u.useState([]),[E,W]=u.useState(),[A,m]=u.useState(!1),se=Ce();ye(se.breakpoints.down("md"));const p=ve(a=>a.persistData.user.userInfo),[d,re]=u.useState(B),[b,_]=u.useState(""),[S,te]=u.useState({brand:O[1].value,storage:G[0].value,color:q[0].value,RAM:$[0].value}),[D,oe]=u.useState({brand:Y[1].value,storage:Q[0].value,RAM:H[0].value}),[g,le]=u.useState({type:"rent",parking:!1,furnished:!1,bedrooms:"",bath:""}),[r,F]=u.useState({description:"",imageURLs:[],regularPrice:"",discountPrice:"",mobileNumber:"",offer:!1});u.useEffect(()=>{switch(d){case k:{_(V);break}}},[d]);const ne=a=>{re(a.target.value),F(s=>({...s,offer:!1}))},ie=a=>{_(a.target.value)},j=a=>{F(s=>({...s,[a.target.name]:a.target.type=="checkbox"?a.target.checked:a.target.value}))},I=u.useCallback(a=>{const s=a.target.name,l=a.target.type;le(o=>s=="type"?{...o,[a.target.name]:a.target.value}:l=="checkbox"?{...o,[a.target.name]:a.target.checked}:{...o,[a.target.name]:a.target.value})},[]),L=a=>{te(s=>({...s,[a.target.name]:a.target.value}))},U=a=>{oe(s=>({...s,[a.target.name]:a.target.value}))},ue=a=>{F(s=>({...s,imageURLs:[...r.imageURLs.filter(l=>l!==a)]}))},ce=a=>{a.target.files.length<7&&ae(a.target.files)},de=()=>{if(w.length>0&&w.length+r.imageURLs.length<7){const s=[];n.info("Uploading photo, please wait"),m(!0);for(var a=0;a<w.length;a++)s.push(fe(w[a]));Promise.all(s).then(l=>{F(o=>({...o,imageURLs:r.imageURLs.concat(l)})),m(!0)}).then(()=>{W(!1)}).catch(l=>{n.error("image Upload failed.Image should be 2mb "),console.log(l.message)}).finally(()=>{m(!1)})}else W("Please choose only six images for every list"),n.error("Please choose only six images for every list")},me=async(a,s)=>{var l,o;try{const i=await J.put(`api/user/update/${a}`,{mobileNumber:s});return((l=i==null?void 0:i.data)==null?void 0:l.succeess)==!1?{success:!1,message:(o=i==null?void 0:i.data)==null?void 0:o.message}:{success:!0}}catch(i){return{success:!1,message:i.message}}},he=async a=>{var s,l;try{const o=await J.post("api/listing/create",{...a,discountPrice:r.offer?r.discountPrice:0});return console.log(o),n.success("Your product added successfully"),{succeess:!0,data:o==null?void 0:o.data}}catch(o){return console.log(o),n.error((l=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:l.message),{success:!1,message:o.message}}finally{m(!1)}},ge=async a=>{if(a.preventDefault(),!r.name||!r.description||!r.address||r.imageURLs.length===0){n.error("Please provide the required information");return}if(!p.mobileNumber){if(!Ne(r.mobileNumber)){n.error("Telephone number Should Contain only numbers");return}if(!we(r.mobileNumber)){n.error("Mobile number should be 10 digits");return}}const s=parseFloat(r.discountPrice),l=parseFloat(r.regularPrice);if(d==="estate"){const x=parseFloat(g.bedrooms),M=parseFloat(g.bath);if(isNaN(x)||x<=0){n.error("Beds must be greater than zero");return}if(isNaN(M)||M<=0){n.error("Bath must be greater than zero");return}if(isNaN(l)||l<=0){n.error("Price must be greater than zero");return}}if(r.offer){if(isNaN(s)||s<=0){n.error("Discount price must be greater than zero");return}if(s>=l){n.error("Discount must be smaller than the regular price");return}}if(m(!0),!p.mobileNumber){const x=await me(p.id,r.mobileNumber);if(x.success==!1){n.error(x.message),W(x.message),m(!1);return}n.success("Your mobile number updated"),ee(Ae({...p,mobileNumber:r.mobileNumber}))}const o=xe(d),i=await he(o);if(i.success==!1){m(!1);return}m(!1),X(`/listing/${i.data._id+","+d+","+b}`)},xe=a=>{let s={mainCategory:a,...r};switch(a){case B:{s={...s,...g};break}case k:{switch(b){case V:{s={...s,...S,subCategory:b};break}case Z:{s={...s,...D,subCategory:b};break}}break}}return s},fe=async a=>new Promise((s,l)=>{const o=De(We),i=a.name+new Date().getTime(),x=Fe(o,i),M=Le(x,a);M.on("state_changed",C=>{C.bytesTransferred/C.totalBytes*100},C=>{n.error(C.message),m(!1),l(C)},()=>{console.log("down url"),Ve(M.snapshot.ref).then(C=>{s(C)})})});return e.jsxs(Ue,{maxWidth:"lg",sx:{py:4},children:[e.jsx(u.Suspense,{fallback:e.jsx(Re,{}),children:e.jsx(c,{variant:"h4",fontWeight:"bold",mb:3,children:"Create Listing"})}),e.jsx(t,{container:!0,spacing:4,children:e.jsx(t,{item:!0,xs:12,children:e.jsxs(Pe,{elevation:2,sx:{p:2,borderRadius:2,maxHeight:"80vh",overflowY:"auto"},children:[e.jsxs(v,{defaultExpanded:!0,children:[e.jsx(R,{expandIcon:e.jsx(y,{}),children:e.jsx(c,{variant:"h6",fontWeight:500,children:"General Info"})}),e.jsx(P,{children:e.jsxs(Se,{display:"flex",flexDirection:"column",gap:2,children:[e.jsx(h,{name:"Choose Category",label:"Choose Category",defaultValue:"ALL PRODUCTS",value:d,handleValueMethod:ne,items:Ie.filter(a=>a.value!==Me)}),d===k&&e.jsx(h,{name:"Choose Sub Category",label:"Choose Sub Category",defaultValue:V,value:b,items:ke,handleValueMethod:ie}),e.jsx(f,{label:"Name",name:"name",value:r.name||"",onChange:j,fullWidth:!0}),e.jsx(f,{label:"Description",name:"description",multiline:!0,maxRows:6,value:r.description||"",onChange:j,fullWidth:!0}),e.jsx(f,{label:"Address",name:"address",value:r.address||"",onChange:j,fullWidth:!0}),!(p!=null&&p.mobileNumber)&&e.jsx(f,{label:"Mobile",name:"mobileNumber",value:r.mobileNumber||"",onChange:j,fullWidth:!0})]})})]}),d===B&&e.jsxs(v,{children:[e.jsx(R,{expandIcon:e.jsx(y,{}),children:e.jsx(c,{variant:"h6",fontWeight:500,children:"Property Details"})}),e.jsx(P,{children:e.jsxs(t,{container:!0,spacing:2,children:[e.jsxs(t,{item:!0,xs:12,children:[e.jsx(c,{variant:"subtitle1",fontWeight:500,mb:1,children:"Type"}),e.jsxs(Be,{row:!0,name:"type",value:g.type,onChange:I,sx:{flexWrap:"wrap"},children:[e.jsx(N,{value:"sell",control:e.jsx(K,{size:"small"}),label:"Sell",sx:{mr:2}}),e.jsx(N,{value:"rent",control:e.jsx(K,{size:"small"}),label:"Rent",sx:{mr:2}})]})]}),e.jsxs(t,{item:!0,xs:12,children:[e.jsx(c,{variant:"subtitle1",fontWeight:500,mb:1,children:"Options"}),e.jsxs(Te,{row:!0,sx:{flexWrap:"wrap"},children:[e.jsx(N,{control:e.jsx(z,{size:"small",checked:g.parking||!1,onChange:I,name:"parking"}),label:"Parking Spot",sx:{mr:2}}),e.jsx(N,{control:e.jsx(z,{size:"small",checked:g.furnished||!1,onChange:I,name:"furnished"}),label:"Furnished",sx:{mr:2}})]})]}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(f,{fullWidth:!0,label:"Beds",type:"number",name:"bedrooms",value:g.bedrooms,onChange:I,size:"small"})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(f,{fullWidth:!0,label:"Baths",type:"number",name:"bath",value:g.bath,onChange:I,size:"small"})})]})})]}),d===k&&b===V&&e.jsxs(v,{sx:{overflow:"hidden",bgcolor:"background.paper"},children:[e.jsx(R,{expandIcon:e.jsx(y,{}),children:e.jsx(c,{variant:"h6",fontWeight:500,children:"Device Details"})}),e.jsx(P,{sx:{px:3,py:2},children:e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(h,{label:"Brand",name:"brand",defaultValue:"Samsung",value:S.brand,items:O.filter(a=>a.name!="ALL BRANDS"),handleValueMethod:L})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(h,{label:"Storage",name:"storage",defaultValue:"Choose Storage",value:S.storage,items:G,handleValueMethod:L})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(h,{label:"RAM",name:"RAM",defaultValue:"Choose RAM",value:S.RAM,items:$,handleValueMethod:L})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(h,{label:"Color",name:"color",defaultValue:"Choose Color",value:S.color,items:q,handleValueMethod:L})})]})})]}),d===k&&b===Z&&e.jsxs(v,{sx:{overflow:"hidden",bgcolor:"background.paper"},children:[e.jsx(R,{expandIcon:e.jsx(y,{}),children:e.jsx(c,{variant:"h6",fontWeight:500,children:"Device Details"})}),e.jsx(P,{sx:{px:3,py:2},children:e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(h,{label:"Brand",name:"brand",defaultValue:"DELL",value:D.brand,items:Y.filter(a=>a.name!="ALL BRANDS"),handleValueMethod:U})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(h,{label:"Storage",name:"storage",defaultValue:"Choose Storage",value:D.storage,items:Q,handleValueMethod:U})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(h,{label:"RAM",name:"RAM",defaultValue:"Choose RAM",value:D.RAM,items:H,handleValueMethod:U})})]})})]}),e.jsxs(v,{children:[e.jsx(R,{expandIcon:e.jsx(y,{}),children:e.jsx(c,{variant:"h6",fontWeight:500,children:"Pricing"})}),e.jsx(P,{children:e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{item:!0,xs:12,children:e.jsx(N,{control:e.jsx(z,{checked:r.offer||!1,onChange:j,name:"offer"}),label:"This listing has an offer"})}),e.jsx(t,{item:!0,xs:12,sm:4,children:e.jsx(f,{fullWidth:!0,label:"Regular Price",type:"number",name:"regularPrice",value:r.regularPrice,onChange:j,size:"small"})}),r.offer&&e.jsx(t,{item:!0,xs:12,sm:4,children:e.jsx(f,{fullWidth:!0,label:"Discount Price",type:"number",name:"discountPrice",value:r.discountPrice,onChange:j,size:"small",color:"success"})})]})})]}),e.jsxs(v,{children:[e.jsx(R,{expandIcon:e.jsx(y,{}),children:e.jsx(c,{variant:"h6",fontWeight:500,children:"Upload Images"})}),e.jsxs(P,{children:[e.jsx(c,{variant:"body2",color:"text.secondary",mb:2,children:"The first image will be the cover (maximum: 6)"}),e.jsxs(t,{container:!0,spacing:2,mb:2,children:[e.jsx(t,{item:!0,xs:12,sm:8,children:e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:ce,style:{width:"100%"}})}),e.jsx(t,{item:!0,xs:12,sm:4,children:e.jsx(T,{fullWidth:!0,variant:"contained",color:"success",onClick:de,disabled:A,children:A?"Uploading...":"Upload"})})]}),E&&e.jsx(c,{color:"error",variant:"body2",mb:2,children:E}),e.jsx(t,{container:!0,spacing:2,mb:2,children:r.imageURLs.map((a,s)=>e.jsxs(t,{item:!0,xs:12,sm:6,md:4,display:"flex",alignItems:"center",gap:1,children:[e.jsx("img",{src:a,alt:`uploaded-${s}`,style:{width:100,height:100,borderRadius:5,objectFit:"contain"}}),e.jsx(T,{variant:"text",color:"error",onClick:()=>ue(a),children:"Delete"})]},s))})]})]}),e.jsx(T,{variant:"contained",color:"success",onClick:ge,disabled:A,sx:{mt:4,width:{xs:"100%",sm:"auto"},px:4,py:1.5,fontSize:{xs:"0.9rem",sm:"1rem"},alignSelf:"center",display:"block",mx:{sm:"auto"}},children:A?"Loading...":"Create Listing"})]})})})]})};export{ua as default};
