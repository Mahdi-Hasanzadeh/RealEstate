import{j as t,B as y,a6 as k,T as p,r as o,z as W,y as B,F as D,c as f,U as m,v as g}from"./index-B6Jh5Kqf.js";import{N as z,d as A,I as R}from"./ItemCard-B4y_lpWM.js";import{C as T}from"./ConfirmDialog-DcO7_sss.js";import{C as u}from"./Container-Dhm7lGM3.js";import"./SearchOff-DCa9dXma.js";import"./Card-BH7gk7ep.js";import"./CardMedia-Cgk7daUN.js";import"./Zoom-BGt3lVFV.js";import"./styled-lc6bJm8w.js";const U=({error:i})=>t.jsxs(y,{sx:{minHeight:"50vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",color:"error.main",px:2},children:[t.jsx(k,{sx:{fontSize:80,mb:2}}),t.jsx(p,{variant:"h5",fontWeight:"bold",gutterBottom:!0,children:"Something went wrong"}),t.jsx(p,{variant:"body1",children:i})]}),P=()=>{const[i,l]=o.useState(!1),[r,j]=o.useState(null),[C,x]=o.useState(!1),[w,c]=o.useState(null),[h,d]=o.useState([]),v=W(e=>e.persistData.user.userInfo),F=B(),S=()=>l(!1),$=()=>{r!=null&&r.id&&(E(r.id),l(!1))},b=e=>{j({id:e._id,name:e.name}),l(!0)},I=e=>{const s=`/listing/${e._id},${e.mainCategoryName},${e.subCategoryName||"null"}`;F(s)},L=async()=>{var e;x(!0);try{const{data:s}=await f.get(`${m}api/user/userInfo/${v.id}`);if(!((e=s==null?void 0:s.favorites)!=null&&e.length)){d([]),c(null);return}const n=s.favorites.join(","),{data:a}=await f.get(`${m}api/listing/favoriteListings?ListingsId=${n}`);d(a),c(null)}catch(s){c(s.message||"Something went wrong."),g.error(s.message||"Failed to fetch favorites.")}finally{x(!1)}},E=async e=>{var s,n;try{if(!(await f.put(`${m}api/user/update/${v.id}/favorites`,{favorites:e,removeFavorites:!0})).data)throw new Error("Failed to remove from favorites.");g.success("Removed from favorites."),d(N=>N.filter(_=>_._id!==e))}catch(a){g.error(((n=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:n.message)||a.message)}};return o.useEffect(()=>{L()},[]),C?t.jsx(D,{}):w?t.jsx(u,{maxWidth:"lg",sx:{py:6},children:t.jsx(U,{})}):h.length===0?t.jsx(u,{maxWidth:"lg",sx:{py:6},children:t.jsx(z,{message:"No Favorites",description:"You havenâ€™t saved anything yet.",icon:t.jsx(A,{sx:{fontSize:80,color:"grey.500",mb:2}})})}):t.jsxs(u,{maxWidth:"lg",sx:{pb:6},children:[t.jsx(p,{variant:"h5",align:"center",sx:{color:"green",mb:4},children:"Your Favorites"}),t.jsx(y,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)",lg:"repeat(3, 1fr)"},gap:3,p:2,pb:8},children:h.map((e,s)=>t.jsx(R,{item:e,onDeleteClick:()=>b(e),showView:!0,onViewClick:I},e._id||s))}),t.jsx(T,{open:i,title:"Warning",message:`Are you sure to delete listing (${r==null?void 0:r.name})?`,onClose:S,onConfirm:$,cancelText:"Disagree",confirmText:"Agree"})]})};export{P as default};
