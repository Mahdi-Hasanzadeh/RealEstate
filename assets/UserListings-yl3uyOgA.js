import{y as I,r as o,x as T,j as s,B as f,F as B,b as g,U as p,A as i}from"./index-BTe4GArI.js";import{N as D,d as E,I as U}from"./ItemCard-e8CUoWnt.js";import{L as _}from"./createSvgIcon-Dye2LVBh.js";import{C as F}from"./ConfirmDialog-5tg7-0iW.js";import{C as v}from"./Container-CSPSROeH.js";import"./Card-Byf1yaOd.js";import"./CardMedia-qNnUd2Z2.js";import"./isMuiElement-DIt3a8Dx.js";import"./Zoom-BQjlFhF1.js";import"./styled-fWTeZ0ma.js";const x=3e3,M=()=>{const h=I(e=>e.persistData.user.userInfo),[n,m]=o.useState([]),[C,d]=o.useState(!0),[a,y]=o.useState({}),[j,c]=o.useState(!1),L=T(),S=()=>{c(!1)},$=()=>{b(a==null?void 0:a.id),c(!1)},N=async()=>{var e;try{d(!0);const t=await g.get(`${p}api/listing/${h.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}});if(t.data.succeess===!1){i.error((e=t==null?void 0:t.data)==null?void 0:e.message,{autoClose:x});return}m(t.data)}catch(t){i.error(t.message,{autoClose:x})}finally{d(!1)}},b=async e=>{var t,u;try{const r=n.filter(l=>l._id==e)[0],w=await g.delete(`${p}api/listing/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},data:{mainCategoryName:r.mainCategoryName}});i.success("Listing Deleted Successfully");const A=n.filter(l=>l._id!=e);m(A)}catch(r){i.error(((u=(t=r==null?void 0:r.response)==null?void 0:t.data)==null?void 0:u.message)||r.message)}},k=e=>{L(`/listing/update/${e==null?void 0:e._id},${e==null?void 0:e.mainCategoryName},${(e==null?void 0:e.subCategoryName)||null}`)};return o.useEffect(()=>{N()},[]),C?s.jsx(f,{sx:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"20%"},children:s.jsx(_,{})}):n.length===0?s.jsx(o.Suspense,{fallback:s.jsx(B,{}),children:s.jsx(D,{message:"No Listings",description:"You havenâ€™t created any listings yet.",icon:s.jsx(E,{sx:{fontSize:80,color:"grey.500",mb:2}})})}):s.jsxs(s.Fragment,{children:[s.jsxs(v,{maxWidth:"lg",children:[s.jsxs("h2",{style:{color:"green",textAlign:"center"},children:["Your Listings (",n.length,")"]}),s.jsx(f,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)",lg:"repeat(3, 1fr)"},gap:3,p:2,pb:10},children:n.map((e,t)=>s.jsx(U,{item:e,onDeleteClick:()=>{c(!0),y({id:e._id,name:e.name})},onEditClick:()=>k(e),showEdit:!0},t))})]}),s.jsx(F,{open:j,title:"Warning",message:`Are you sure to delete listing (${a==null?void 0:a.name})?`,onClose:S,onConfirm:$,cancelText:"Disagree",confirmText:"Agree"})]})};export{M as default};
