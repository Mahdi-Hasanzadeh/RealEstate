function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/WaveHeader-GOCtbZ2g.js","assets/index-RV5YIsxB.js","assets/index-DDnostVl.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{r as u,_ as ue,p as me,o as de,u as he,b as ge,q as fe,$ as U,af as E,J as _,ag as G,H as O,a4 as M,Y as T,j as e,F as xe,T as m,S as be,B as pe,a5 as je,a8 as ye,a6 as Ce,a as A,v as n,ah as ve,ai as Pe,C as Re}from"./index-RV5YIsxB.js";import{A as P,a as R,d as S,b as I}from"./ExpandMore-CR451P-6.js";import{g as Se,r as Ie,u as Ne,a as ke}from"./index.esm2017-xdxYMBNT.js";import{a as Fe}from"./firebase-Dc1fJsNB.js";import j from"./ComboBox-CEHXVqoE.js";import{a as q}from"./axiosConfig-CWlSV8Gi.js";import{C as we}from"./Container-BPfE54Zb.js";import{G as o}from"./Grid-DGzFf4fj.js";import{T as f}from"./TextField-CP7HvCbv.js";import{R as De,a as Y,F as Le}from"./RadioGroup-C92KUvlz.js";import{F as N}from"./FormControlLabel-CLuHO4QX.js";import{C as V}from"./Checkbox-AbB0sQZ5.js";import"./useSlot-Bsk3VM8j.js";import"./Collapse-DCJMqTj9.js";import"./MenuItem-BofZIsp5.js";import"./List-Clvs1NRc.js";import"./dividerClasses-t4SbNxUS.js";import"./listItemTextClasses-Bs8U03QR.js";import"./styled-DolKx1nG.js";import"./useFormControl-x1edabWd.js";import"./Stack-KQcwQfyK.js";u.lazy(()=>ue(()=>import("./WaveHeader-GOCtbZ2g.js"),__vite__mapDeps([0,1,2])));const ea=()=>{const $=me(),H=de(),[k,J]=u.useState([]),[B,F]=u.useState(),[w,d]=u.useState(!1),Q=he();ge(Q.breakpoints.down("md"));const x=fe(a=>a.persistData.user.userInfo),[h,K]=u.useState(U),[D,z]=u.useState(""),[y,X]=u.useState({brand:E[1].value,storage:_[0].value,color:G[0].value,RAM:O[0].value}),[g,Z]=u.useState({type:"rent",parking:!1,furnished:!1,bedrooms:"",bath:""}),[t,L]=u.useState({description:"",imageURLs:[],regularPrice:"",discountPrice:"",mobileNumber:"",offer:!1});u.useEffect(()=>{switch(h){case M:{z(T);break}}},[h]);const ee=a=>{K(a.target.value),L(s=>({...s,offer:!1}))},ae=a=>{z(a.target.value)},b=a=>{L(s=>({...s,[a.target.name]:a.target.type=="checkbox"?a.target.checked:a.target.value}))},C=u.useCallback(a=>{const s=a.target.name,l=a.target.type;Z(c=>s=="type"?{...c,[a.target.name]:a.target.value}:l=="checkbox"?{...c,[a.target.name]:a.target.checked}:{...c,[a.target.name]:a.target.value})},[]),W=a=>{X(s=>({...s,[a.target.name]:a.target.value}))},se=a=>{L(s=>({...s,imageURLs:[...t.imageURLs.filter(l=>l!==a)]}))},re=a=>{a.target.files.length<7&&J(a.target.files)},te=()=>{if(k.length>0&&k.length+t.imageURLs.length<7){const s=[];n.info("Uploading photo, please wait"),d(!0);for(var a=0;a<k.length;a++)s.push(ce(k[a]));Promise.all(s).then(l=>{L(c=>({...c,imageURLs:t.imageURLs.concat(l)})),d(!0)}).then(()=>{F(!1)}).catch(l=>{n.error("image Upload failed.Image should be 2mb "),console.log(l.message)}).finally(()=>{d(!1)})}else F("Please choose only six images for every list"),n.error("Please choose only six images for every list")},oe=async(a,s)=>{var l,c;try{const i=await q.put(`api/user/update/${a}`,{mobileNumber:s});return((l=i==null?void 0:i.data)==null?void 0:l.succeess)==!1?{success:!1,message:(c=i==null?void 0:i.data)==null?void 0:c.message}:{success:!0}}catch(i){return{success:!1,message:i.message}}},le=async a=>{var s,l,c,i;try{const r=await q.post("api/listing/create",{...a,discountPrice:t.offer?t.discountPrice:0});return((s=r==null?void 0:r.data)==null?void 0:s.succeess)==!1?(n.error((l=r==null?void 0:r.data)==null?void 0:l.message),F((c=r==null?void 0:r.data)==null?void 0:c.message),{success:!1,message:(i=r==null?void 0:r.data)==null?void 0:i.message}):(n.success("Your product added successfully"),{succeess:!0,data:r==null?void 0:r.data})}catch(r){return n.error(r.message),{success:!1,message:r.message}}finally{d(!1)}},ne=async a=>{if(a.preventDefault(),!t.name||!t.description||!t.address||t.imageURLs.length===0){n.error("Please provide the required information");return}if(!x.mobileNumber){if(!ve(t.mobileNumber)){n.error("Telephone number Should Contain only numbers");return}if(!Pe(t.mobileNumber)){n.error("Mobile number should be 10 digits");return}}const s=parseFloat(t.discountPrice),l=parseFloat(t.regularPrice);if(h==="estate"){const r=parseFloat(g.bedrooms),v=parseFloat(g.bath);if(isNaN(r)||r<=0){n.error("Beds must be greater than zero");return}if(isNaN(v)||v<=0){n.error("Bath must be greater than zero");return}if(isNaN(l)||l<=0){n.error("Price must be greater than zero");return}}if(t.offer){if(isNaN(s)||s<=0){n.error("Discount price must be greater than zero");return}if(s>=l){n.error("Discount must be smaller than the regular price");return}}if(d(!0),!x.mobileNumber){const r=await oe(x.id,t.mobileNumber);if(r.success==!1){n.error(r.message),F(r.message),d(!1);return}n.success("Your mobile number updated"),H(Re({...x,mobileNumber:t.mobileNumber}))}const c=ie(h),i=await le(c);if(i.success==!1){d(!1);return}d(!1),$(`/listing/${i.data._id+","+h+","+D}`)},ie=a=>{let s={mainCategory:a,...t};switch(a){case U:{s={...s,...g};break}case M:{s={...s,...y,subCategory:D};break}}return s},ce=async a=>new Promise((s,l)=>{const c=Se(Fe),i=a.name+new Date().getTime(),r=Ie(c,i),v=Ne(r,a);v.on("state_changed",p=>{p.bytesTransferred/p.totalBytes*100},p=>{n.error(p.message),d(!1),l(p)},()=>{console.log("down url"),ke(v.snapshot.ref).then(p=>{s(p)})})});return e.jsxs(we,{maxWidth:"lg",sx:{py:4},children:[e.jsx(u.Suspense,{fallback:e.jsx(xe,{}),children:e.jsx(m,{variant:"h4",fontWeight:"bold",mb:3,children:"Create Listing"})}),e.jsx(o,{container:!0,spacing:4,children:e.jsx(o,{item:!0,xs:12,children:e.jsxs(be,{elevation:2,sx:{p:2,borderRadius:2,maxHeight:"80vh",overflowY:"auto"},children:[e.jsxs(P,{defaultExpanded:!0,children:[e.jsx(R,{expandIcon:e.jsx(S,{}),children:e.jsx(m,{variant:"h6",fontWeight:500,children:"General Info"})}),e.jsx(I,{children:e.jsxs(pe,{display:"flex",flexDirection:"column",gap:2,children:[e.jsx(j,{name:"Choose Category",defaultValue:"ALL PRODUCTS",value:h,handleValueMethod:ee,items:je.filter(a=>a.value!==ye)}),h===M&&e.jsx(j,{name:"Choose Sub Category",defaultValue:T,value:D,items:Ce,handleValueMethod:ae}),e.jsx(f,{label:"Name",name:"name",value:t.name||"",onChange:b,fullWidth:!0}),e.jsx(f,{label:"Description",name:"description",multiline:!0,maxRows:6,value:t.description||"",onChange:b,fullWidth:!0}),e.jsx(f,{label:"Address",name:"address",value:t.address||"",onChange:b,fullWidth:!0}),!(x!=null&&x.mobileNumber)&&e.jsx(f,{label:"Mobile",name:"mobileNumber",value:t.mobileNumber||"",onChange:b,fullWidth:!0})]})})]}),h===U&&e.jsxs(P,{children:[e.jsx(R,{expandIcon:e.jsx(S,{}),children:e.jsx(m,{variant:"h6",fontWeight:500,children:"Property Details"})}),e.jsx(I,{children:e.jsxs(o,{container:!0,spacing:2,children:[e.jsxs(o,{item:!0,xs:12,children:[e.jsx(m,{variant:"subtitle1",fontWeight:500,mb:1,children:"Type"}),e.jsxs(De,{row:!0,name:"type",value:g.type,onChange:C,sx:{flexWrap:"wrap"},children:[e.jsx(N,{value:"sell",control:e.jsx(Y,{size:"small"}),label:"Sell",sx:{mr:2}}),e.jsx(N,{value:"rent",control:e.jsx(Y,{size:"small"}),label:"Rent",sx:{mr:2}})]})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx(m,{variant:"subtitle1",fontWeight:500,mb:1,children:"Options"}),e.jsxs(Le,{row:!0,sx:{flexWrap:"wrap"},children:[e.jsx(N,{control:e.jsx(V,{size:"small",checked:g.parking||!1,onChange:C,name:"parking"}),label:"Parking Spot",sx:{mr:2}}),e.jsx(N,{control:e.jsx(V,{size:"small",checked:g.furnished||!1,onChange:C,name:"furnished"}),label:"Furnished",sx:{mr:2}})]})]}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(f,{fullWidth:!0,label:"Beds",type:"number",name:"bedrooms",value:g.bedrooms,onChange:C,size:"small"})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(f,{fullWidth:!0,label:"Baths",type:"number",name:"bath",value:g.bath,onChange:C,size:"small"})})]})})]}),h===M&&D===T&&e.jsxs(P,{sx:{overflow:"hidden",bgcolor:"background.paper"},children:[e.jsx(R,{expandIcon:e.jsx(S,{}),children:e.jsx(m,{variant:"h6",fontWeight:500,children:"Device Details"})}),e.jsx(I,{sx:{px:3,py:2},children:e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(j,{label:"Brand",name:"brand",defaultValue:"Samsung",value:y.brand,items:E.filter(a=>a.name!="ALL BRANDS"),handleValueMethod:W})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(j,{label:"Storage",name:"storage",defaultValue:"Choose Storage",value:y.storage,items:_,handleValueMethod:W})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(j,{label:"RAM",name:"RAM",defaultValue:"Choose RAM",value:y.RAM,items:O,handleValueMethod:W})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(j,{label:"Color",name:"color",defaultValue:"Choose Color",value:y.color,items:G,handleValueMethod:W})})]})})]}),e.jsxs(P,{children:[e.jsx(R,{expandIcon:e.jsx(S,{}),children:e.jsx(m,{variant:"h6",fontWeight:500,children:"Pricing"})}),e.jsx(I,{children:e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(N,{control:e.jsx(V,{checked:t.offer||!1,onChange:b,name:"offer"}),label:"This listing has an offer"})}),e.jsx(o,{item:!0,xs:12,sm:4,children:e.jsx(f,{fullWidth:!0,label:"Regular Price",type:"number",name:"regularPrice",value:t.regularPrice,onChange:b,size:"small"})}),t.offer&&e.jsx(o,{item:!0,xs:12,sm:4,children:e.jsx(f,{fullWidth:!0,label:"Discount Price",type:"number",name:"discountPrice",value:t.discountPrice,onChange:b,size:"small",color:"success"})})]})})]}),e.jsxs(P,{children:[e.jsx(R,{expandIcon:e.jsx(S,{}),children:e.jsx(m,{variant:"h6",fontWeight:500,children:"Upload Images"})}),e.jsxs(I,{children:[e.jsx(m,{variant:"body2",color:"text.secondary",mb:2,children:"The first image will be the cover (maximum: 6)"}),e.jsxs(o,{container:!0,spacing:2,mb:2,children:[e.jsx(o,{item:!0,xs:12,sm:8,children:e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:re,style:{width:"100%"}})}),e.jsx(o,{item:!0,xs:12,sm:4,children:e.jsx(A,{fullWidth:!0,variant:"contained",color:"success",onClick:te,disabled:w,children:w?"Uploading...":"Upload"})})]}),B&&e.jsx(m,{color:"error",variant:"body2",mb:2,children:B}),e.jsx(o,{container:!0,spacing:2,mb:2,children:t.imageURLs.map((a,s)=>e.jsxs(o,{item:!0,xs:12,sm:6,md:4,display:"flex",alignItems:"center",gap:1,children:[e.jsx("img",{src:a,alt:`uploaded-${s}`,style:{width:100,height:100,borderRadius:5,objectFit:"contain"}}),e.jsx(A,{variant:"text",color:"error",onClick:()=>se(a),children:"Delete"})]},s))})]})]}),e.jsx(A,{variant:"contained",color:"success",onClick:ne,disabled:w,sx:{mt:4,width:{xs:"100%",sm:"auto"},px:4,py:1.5,fontSize:{xs:"0.9rem",sm:"1rem"},alignSelf:"center",display:"block",mx:{sm:"auto"}},children:w?"Loading...":"Create Listing"})]})})})]})};export{ea as default};
