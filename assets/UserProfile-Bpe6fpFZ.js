function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/WaveHeader-2ifJBkZW.js","assets/index-B5lp3evd.js","assets/index-DDnostVl.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{l as fe,n as xe,J as te,s as B,K as A,g as N,M as re,r as n,k as be,e as ye,j as e,o as ve,p as Ce,_ as ke,y as D,u as je,w as Se,x as Pe,b as we,A as c,F as Te,O as Ne,B as w,T,I as $e,z as M,a as Q,L as Ie,c as G,U as J,Q as Re,E as Z,S as q}from"./index-B5lp3evd.js";import{g as _e,r as ze,u as Me,a as Ue}from"./index.esm2017-xdxYMBNT.js";import{a as Ae}from"./firebase-Dc1fJsNB.js";import{C as Ee}from"./ConfirmDialog-Da_hVYY9.js";import{C as Fe}from"./Container-Buy3LPWA.js";import{T as U}from"./TextField-B_elwkSM.js";import{I as We,V as Le,a as Be}from"./InputAdornment-uKqgwYYo.js";import"./Zoom-BfKw8cCT.js";import"./styled-Dql5uali.js";import"./useFormControl-B6FoJptF.js";import"./isMuiElement-Cht4bAAw.js";function Ve(r){return fe("MuiCircularProgress",r)}xe("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Oe=["className","color","disableShrink","size","style","thickness","value","variant"];let E=r=>r,H,X,Y,ee;const g=44,Ke=te(H||(H=E`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),De=te(X||(X=E`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),Qe=r=>{const{classes:o,variant:l,color:u,disableShrink:t}=r,h={root:["root",l,`color${A(u)}`],svg:["svg"],circle:["circle",`circle${A(l)}`,t&&"circleDisableShrink"]};return Ce(h,Ve,o)},Ge=B("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(r,o)=>{const{ownerState:l}=r;return[o.root,o[l.variant],o[`color${A(l.color)}`]]}})(({ownerState:r,theme:o})=>N({display:"inline-block"},r.variant==="determinate"&&{transition:o.transitions.create("transform")},r.color!=="inherit"&&{color:(o.vars||o).palette[r.color].main}),({ownerState:r})=>r.variant==="indeterminate"&&re(Y||(Y=E`
      animation: ${0} 1.4s linear infinite;
    `),Ke)),Je=B("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(r,o)=>o.svg})({display:"block"}),Ze=B("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(r,o)=>{const{ownerState:l}=r;return[o.circle,o[`circle${A(l.variant)}`],l.disableShrink&&o.circleDisableShrink]}})(({ownerState:r,theme:o})=>N({stroke:"currentColor"},r.variant==="determinate"&&{transition:o.transitions.create("stroke-dashoffset")},r.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:r})=>r.variant==="indeterminate"&&!r.disableShrink&&re(ee||(ee=E`
      animation: ${0} 1.4s ease-in-out infinite;
    `),De)),qe=n.forwardRef(function(o,l){const u=be({props:o,name:"MuiCircularProgress"}),{className:t,color:h="primary",disableShrink:f=!1,size:v=40,style:d,thickness:x=3.6,value:b=0,variant:$="indeterminate"}=u,P=ye(u,Oe),p=N({},u,{color:h,disableShrink:f,size:v,thickness:x,value:b,variant:$}),C=Qe(p),k={},I={},s={};if($==="determinate"){const j=2*Math.PI*((g-x)/2);k.strokeDasharray=j.toFixed(3),s["aria-valuenow"]=Math.round(b),k.strokeDashoffset=`${((100-b)/100*j).toFixed(3)}px`,I.transform="rotate(-90deg)"}return e.jsx(Ge,N({className:ve(C.root,t),style:N({width:v,height:v},I,d),ownerState:p,ref:l,role:"progressbar"},s,P,{children:e.jsx(Je,{className:C.svg,ownerState:p,viewBox:`${g/2} ${g/2} ${g} ${g}`,children:e.jsx(Ze,{className:C.circle,style:k,ownerState:p,cx:g,cy:g,r:(g-x)/2,fill:"none",strokeWidth:x})})}))}),He=qe,Xe=n.lazy(()=>ke(()=>import("./WaveHeader-2ifJBkZW.js"),__vite__mapDeps([0,1,2]))),se=3e3,ds=()=>{const[r,o]=n.useState(!1),[l,u]=n.useState(!1),t=D(a=>a.persistData.user.userInfo),h=je(),f=Se(),v=Pe(),d=we(h.breakpoints.down("md")),x=n.useRef(null),[b,$]=n.useState(void 0),P=n.useRef(null),[p,C]=n.useState(0),[k,I]=n.useState(""),[s,j]=n.useState(t),[F,W]=n.useState(""),[V,O]=n.useState(!1),ae=()=>{o(!r)},[oe,L]=n.useState(!1);D(a=>a.showListings.show);const K=()=>{L(!0)},ie=()=>{L(!1)},ne=()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("persist:root"),v("/signin"),f(Z(!1)),f(q())},le=async()=>{try{const a=localStorage.getItem("accessToken");(await G.delete(`${J}api/user/delete/${t.id}`,{headers:{Authorization:`Bearer ${a}`}})).data?(c.success("User deleted Successfully",{autoClose:3e3}),localStorage.removeItem("accessToken"),localStorage.removeItem("persist:root"),L(!1),v("/signup"),f(Z(!1)),f(q())):c.error("user not deleted",{autoClose:3e3})}catch(a){c.error(a.message,{autoClose:3e3})}},ce=async a=>{var _,z,S,m;if(t.username==(s==null?void 0:s.username)&&t.email==(s==null?void 0:s.email)&&t.mobileNumber==(s==null?void 0:s.mobileNumber)&&t.avatar==(s==null?void 0:s.avatar)&&t.password==(s==null?void 0:s.password)){c.info("No changes detected");return}if(!(s!=null&&s.username)||!(s!=null&&s.email)){c.error("Username or email is empty");return}if(!/^\d+$/.test(s==null?void 0:s.mobileNumber)){c.error("Telephone number Should Contain only numbers"),W("Telephone number Should Contain only numbers");return}if((s==null?void 0:s.mobileNumber.length)<10||(s==null?void 0:s.mobileNumber.length)>10){c.error("Mobile number should be 10 digits"),W("Mobile number should be 10 digits");return}try{if(u(!0),!(await G.put(`${J}api/user/update/${t.id}`,{...s},{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`}})).data)throw new Error("Update failed");const{password:Ye,...he}=s;f(Re({...he})),c.success("Profile Updated Successfully",{autoClose:3e3}),C(0)}catch(i){c.error((_=i==null?void 0:i.response)==null?void 0:_.data.message,{autoClose:se}),(S=(z=i==null?void 0:i.response)==null?void 0:z.data)!=null&&S.message?c.error((m=i==null?void 0:i.response)==null?void 0:m.data.message,{autoClose:3e3}):c.error(i.message,{autoClose:3e3})}finally{W(""),u(!1)}},R=a=>{a.target.name=="password"?j(y=>({...y,password:a.target.value==""?t.password:a.target.value})):j(y=>({...y,[a.target.name]:a.target.value}))},ue=()=>{x.current.click()},de=a=>{console.log(a.target.files[0]),$(a.target.files[0])};n.useEffect(()=>(b&&me(b),()=>{P.current&&(P.current.cancel(),console.log("Upload canceled due to route change."))}),[b]);const me=a=>{const y=_e(Ae),_=new Date().getTime()+a.name,z=ze(y,_),S=Me(z,a);P.current=S,S.on("state_changed",m=>{u(!0);const i=m.bytesTransferred/m.totalBytes*100;C(i)},m=>{c.error(m.message,{autoClose:se}),I(m.message),u(!1)},()=>{Ue(S.snapshot.ref).then(async m=>{j(i=>({...i,avatar:m})),u(!1)})})},pe=()=>{V?ne():le()};function ge(a){return e.jsxs(w,{sx:{position:"relative",display:"inline-flex"},children:[e.jsx(He,{variant:"determinate",...a}),e.jsx(w,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(T,{variant:"caption",component:"div",color:"text.secondary",children:`${Math.round(a.value)}%`})})]})}return e.jsx(e.Fragment,{children:e.jsxs(Fe,{maxWidth:"md",sx:{textAlign:"center"},children:[e.jsx(n.Suspense,{fallback:e.jsx(Te,{}),children:e.jsx(Xe,{title:"Profile"})}),e.jsx("input",{onChange:de,type:"file",ref:x,hidden:!0,accept:"image/*"}),e.jsx("img",{onClick:ue,src:s.avatar?s.avatar:t!=null&&t.avatar?t.avatar:Ne,title:t!=null&&t.username?t.username:"user image",style:{cursor:"pointer",width:"120px",objectFit:"cover",objectPosition:"center",borderRadius:50}}),e.jsx(w,{children:p>0&&p<100?e.jsxs(e.Fragment,{children:[e.jsx(T,{children:"Uploading ..."}),e.jsx(ge,{value:p})]}):k?e.jsx(T,{variant:"body1",color:h.palette.error,children:k}):p===100&&e.jsx(T,{variant:"body1",color:h.palette.success,children:"Uploaded Successfully,Please press the update button to save changes"})}),e.jsxs(w,{component:"div",sx:{mx:"auto",mt:5,width:{xs:"99%",sm:"65%",md:"60%"},display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",flexWrap:"wrap",gap:2},children:[e.jsx(U,{type:"text",fullWidth:!0,size:d?"small":"medium",variant:"outlined",label:"Username",defaultValue:t.username,onChange:R,name:"username"}),e.jsx(U,{type:"email",fullWidth:!0,size:d?"small":"medium",variant:"outlined",label:"Email",defaultValue:t.email,onChange:R,name:"email"}),e.jsx(U,{type:r?"text":"password",fullWidth:!0,size:d?"small":"medium",variant:"outlined",label:"Password",defaultValue:"",onChange:R,name:"password",InputProps:{endAdornment:e.jsx($e,{onClick:ae,children:e.jsx(We,{position:"start",children:r?e.jsx(Le,{fontSize:"small"}):e.jsx(Be,{})})})}}),!(t!=null&&t.mobileNumber)&&e.jsx(T,{sx:{color:"red"},children:"Please Add your mobile number"}),e.jsx(U,{error:!!F,type:"text",fullWidth:!0,size:d?"small":"medium",variant:"outlined",label:"Mobile Number",defaultValue:(t==null?void 0:t.mobileNumber)||"",onChange:R,name:"mobileNumber",helperText:F||null}),e.jsx(M,{fullWidth:!0,size:d?"small":"large",variant:"contained",sx:{backgroundColor:Q,"&:hover":{opacity:.9,backgroundColor:Q}},disabled:l,onClick:ce,children:l?"Loading...":"UPDATE"}),e.jsx(Ie,{style:{width:"100%"},className:"Link",to:"/create-list",children:e.jsx(M,{fullWidth:!0,size:d?"small":"large",variant:"contained",color:"success",children:"Create listing"})}),e.jsxs(w,{sx:{width:"100%",display:"flex",justifyContent:"space-between"},children:[e.jsx(M,{variant:"text",color:"warning",size:d?"small":"large",onClick:()=>{O(!1),K()},children:"Delete Account"}),e.jsx(M,{variant:"text",color:"warning",size:d?"small":"large",onClick:()=>{O(!0),K()},children:"Sign out"})]})]}),e.jsx(Ee,{open:oe,onClose:ie,title:"Warning",message:V?"Are you sure you want to sign out from your account?":"Are you sure you want to delete your account?",cancelText:"Disagree",confirmText:"Agree",onConfirm:pe})]})})};export{ds as default};
