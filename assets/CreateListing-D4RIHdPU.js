function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/WaveHeader-BHiRZcyU.js","assets/index-BTe4GArI.js","assets/index-DDnostVl.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{r as c,_ as ne,x as ie,w as ue,u as me,c as ce,y as de,a6 as v,ak as A,X as V,al as W,W as E,a9 as L,a2 as I,j as e,F as ge,B as h,aa as he,ad as fe,ab as xe,am as pe,a7 as be,z as ye,a4 as je,a as D,A as n,an as Ce,ao as Pe,O as ve,b as _,U as q}from"./index-BTe4GArI.js";import{g as ke,r as we,u as Ne,a as Re}from"./index.esm2017-xdxYMBNT.js";import{a as ze}from"./firebase-Dc1fJsNB.js";import j from"./ComboBox-BW1sdltj.js";import{C as Fe}from"./Container-CSPSROeH.js";import{G as T}from"./Grid-Navt_lPB.js";import{T as x}from"./TextField-D-s5_Rcm.js";import{F as k}from"./FormControlLabel-CIRO3eSd.js";import{C as w}from"./Stack-BHCPzfqs.js";import"./MenuItem-CtQV1YnG.js";import"./List-_1a-fvIa.js";import"./dividerClasses-vsPlxeeQ.js";import"./listItemTextClasses-D6ejKpji.js";import"./styled-fWTeZ0ma.js";import"./useFormControl-BSCDjezK.js";import"./isMuiElement-DIt3a8Dx.js";const Se=c.lazy(()=>ne(()=>import("./WaveHeader-BHiRZcyU.js"),__vite__mapDeps([0,1,2]))),Ye=()=>{const O=ie(),G=ue(),[N,$]=c.useState([]),[B,R]=c.useState(),[z,f]=c.useState(!1),Y=me(),o=ce(Y.breakpoints.down("md")),C=de(a=>a.persistData.user.userInfo),[m,H]=c.useState(v),[F,M]=c.useState(""),[P,K]=c.useState({brand:A[1].value,storage:V[0].value,color:W[0].value,RAM:E[0].value}),[d,Q]=c.useState({type:"rent",parking:!1,furnished:!1,bedrooms:"",bath:""}),[s,S]=c.useState({description:"",imageURLs:[],regularPrice:"",discountPrice:"",mobileNumber:"",offer:!1});c.useEffect(()=>{switch(m){case L:{M(I);break}}},[m]);const X=a=>{H(a.target.value),S(t=>({...t,offer:!1}))},J=a=>{M(a.target.value)},p=a=>{S(t=>({...t,[a.target.name]:a.target.type=="checkbox"?a.target.checked:a.target.value}))},y=a=>{const t=a.target.name,i=a.target.type;Q(l=>t=="type"?{...l,[a.target.name]:a.target.value}:i=="checkbox"?{...l,[a.target.name]:a.target.checked}:{...l,[a.target.name]:a.target.value})},U=a=>{K(t=>({...t,[a.target.name]:a.target.value}))},Z=a=>{S(t=>({...t,imageURLs:[...s.imageURLs.filter(i=>i!==a)]}))},ee=a=>{a.target.files.length<7&&$(a.target.files)},ae=()=>{if(N.length>0&&N.length+s.imageURLs.length<7){const t=[];n.info("Uploading photo, please wait"),f(!0);for(var a=0;a<N.length;a++)t.push(oe(N[a]));Promise.all(t).then(i=>{S(l=>({...l,imageURLs:s.imageURLs.concat(i)})),f(!0)}).then(()=>{R(!1)}).catch(i=>{n.error("image Upload failed.Image should be 2mb "),console.log(i.message)}).finally(()=>{f(!1)})}else R("Please choose only six images for every list"),n.error("Please choose only six images for every list")},se=async(a,t)=>{var l,g;const i=localStorage.getItem("accessToken");try{const u=await _.put(`${q}api/user/update/${a}`,{mobileNumber:t},{headers:{Authorization:`Bearer ${i}`}});return((l=u==null?void 0:u.data)==null?void 0:l.succeess)==!1?{success:!1,message:(g=u==null?void 0:u.data)==null?void 0:g.message}:{success:!0}}catch(u){return{success:!1,message:u.message}}},te=async a=>{var i,l,g,u;const t=localStorage.getItem("accessToken");console.log(a);try{const r=await _.post(`${q}api/listing/create`,a,{headers:{Authorization:`Bearer ${t}`}});return((i=r==null?void 0:r.data)==null?void 0:i.succeess)==!1?(n.error((l=r==null?void 0:r.data)==null?void 0:l.message),R((g=r==null?void 0:r.data)==null?void 0:g.message),{success:!1,message:(u=r==null?void 0:r.data)==null?void 0:u.message}):(n.success("Your product added successfully"),{succeess:!0,data:r==null?void 0:r.data})}catch(r){return console.log(r),n.error(r.message),{success:!1,message:r.message}}finally{f(!1)}},re=async a=>{if(a.preventDefault(),!s.name||!s.description||!s.address||s.imageURLs.length===0){n.error("Please provide the required information");return}if(!C.mobileNumber){if(!Ce(s.mobileNumber)){n.error("Telephone number Should Contain only numbers");return}if(!Pe(s.mobileNumber)){n.error("Mobile number should be 10 digits");return}}if(m==="estate"){const l=parseFloat(d.bedrooms),g=parseFloat(d.bath),u=parseFloat(s.regularPrice),r=parseFloat(s.discountPrice);if(isNaN(l)||l<=0){n.error("Beds must be greater than zero");return}if(isNaN(g)||g<=0){n.error("Bath must be greater than zero");return}if(isNaN(u)||u<=0){n.error("Price must be greater than zero");return}if(s.offer){if(isNaN(r)||r<=0){n.error("Discount price must be greater than zero");return}if(r>=u){n.error("Discount must be smaller than the regular price");return}}}else if(m==="Digital_Equipment"&&(!s.regularPrice||parseFloat(s.regularPrice)<=0)){n.error("Price must be greater than zero");return}if(f(!0),!C.mobileNumber){const l=await se(C.id,s.mobileNumber);if(l.success==!1){n.error(l.message),R(l.message),f(!1);return}n.success("Your mobile number updated"),G(ve({...C,mobileNumber:s.mobileNumber}))}const t=le(m),i=await te(t);if(i.success==!1){f(!1);return}f(!1),O(`/listing/${i.data._id+","+m+","+F}`)},le=a=>{let t={mainCategory:a,...s};switch(a){case v:{t={...t,...d};break}case L:{t={...t,...P,subCategory:F};break}}return t},oe=async a=>new Promise((t,i)=>{const l=ke(ze),g=a.name+new Date().getTime(),u=we(l,g),r=Ne(u,a);r.on("state_changed",b=>{b.bytesTransferred/b.totalBytes*100},b=>{n.error(b.message),f(!1),i(b)},()=>{console.log("down url"),Re(r.snapshot.ref).then(b=>{t(b)})})});return e.jsx(e.Fragment,{children:e.jsxs(Fe,{maxWidth:"md",sx:{paddingBottom:10},children:[e.jsx(c.Suspense,{fallback:e.jsx(ge,{}),children:e.jsx(Se,{title:"Create Listing"})}),e.jsxs(T,{container:!0,spacing:o?0:1,justifyContent:o?"normal":"flex-start",children:[e.jsx(T,{item:!0,xs:12,md:6,children:e.jsxs(h,{component:"form",sx:{padding:2},children:[e.jsxs(h,{sx:{display:"flex",flexDirection:"column",rowGap:1},children:[e.jsx(j,{name:"Choose Category",defaultValue:"ALL PRODUCTS",value:m,handleValueMethod:X,items:he.filter(a=>a.value!=fe)}),m==L&&e.jsx(e.Fragment,{children:e.jsx(j,{name:"Choose Sub Category",defaultValue:I,value:F,items:xe,handleValueMethod:J})}),e.jsx(x,{fullWidth:!0,type:"text",label:"Name",variant:"outlined",name:"name",value:s.name||"",onChange:p,required:!0,size:o?"small":"medium"}),e.jsx(x,{multiline:!0,fullWidth:!0,maxRows:10,type:"text",label:"Description",variant:"outlined",name:"description",value:s.description,onChange:p,required:!0,size:o?"small":"medium"}),e.jsx(x,{multiline:!0,fullWidth:!0,maxRows:10,type:"text",label:"address",variant:"outlined",name:"address",value:(s==null?void 0:s.address)||"",onChange:p,required:!0,size:o?"small":"medium"}),!C.mobileNumber&&e.jsx(x,{fullWidth:!0,type:"text",label:"Mobile",variant:"outlined",name:"mobileNumber",value:(s==null?void 0:s.mobileNumber)||"",onChange:p,required:!0,size:o?"small":"medium"})]}),m==v&&e.jsxs(e.Fragment,{children:[e.jsxs(h,{sx:{display:"flex",justifyContent:{xs:"space-between",sm:"flex-start"}},children:[e.jsx(k,{value:"sell",label:"Sell",labelPlacement:"start",name:"type",onChange:y,control:e.jsx(w,{size:o?"small":"medium",checked:d.type==="sell"})}),e.jsx(k,{value:"rent",label:"Rent",labelPlacement:"start",name:"type",onChange:y,control:e.jsx(w,{size:o?"small":"medium",checked:d.type==="rent"})})]}),e.jsxs(h,{sx:{display:"flex",flexWrap:"wrap",flexDirection:{xs:"column",sm:"row"},alignItems:"flex-start",mb:1.5},children:[e.jsx(k,{value:d.parking,label:"Parking spot",labelPlacement:"start",name:"parking",onChange:y,control:e.jsx(w,{size:o?"small":"medium",checked:d.parking||!1})}),e.jsx(k,{value:!0,label:"Furnished",labelPlacement:"start",name:"furnished",onChange:y,control:e.jsx(w,{size:o?"small":"medium",checked:d.furnished||!1})})]})]}),m==L&&F==I&&e.jsxs(e.Fragment,{children:[e.jsx(j,{name:"brand",defaultValue:pe,items:A.filter(a=>a.value!=be),value:P.brand,handleValueMethod:U}),e.jsx(j,{name:"storage",defaultValue:"Choose Storage",items:V,value:P.storage,handleValueMethod:U}),e.jsx(j,{name:"RAM",defaultValue:"Choose RAM",value:P.RAM,items:E,handleValueMethod:U}),e.jsx(j,{name:"color",defaultValue:"Choose Color",items:W,value:P.color,handleValueMethod:U})]}),m==v&&e.jsx(h,{sx:{display:"flex",flexWrap:"wrap",flexDirection:{xs:"column",sm:"row"},alignItems:"flex-start",mb:1.5},children:e.jsx(k,{value:!0,label:"Offer",labelPlacement:"start",name:"offer",onChange:p,control:e.jsx(w,{size:o?"small":"medium",checked:s.offer||!1})})}),e.jsxs(h,{sx:{display:"flex",justifyContent:"flex-start",gap:3,flexWrap:"wrap",marginTop:2},children:[m==v&&e.jsxs(e.Fragment,{children:[e.jsx(x,{type:"number",label:"Beds",size:o?"small":"medium",name:"bedrooms",value:d.bedrooms,onChange:y}),e.jsx(x,{type:"number",label:"Baths",size:o?"small":"medium",name:"bath",value:d.bath,onChange:y})]}),e.jsx(x,{type:"number",label:"Price",size:o?"small":"medium",name:"regularPrice",value:s.regularPrice,onChange:p}),s.offer&&e.jsx(x,{type:"number",label:"Discount",size:o?"small":"medium",name:"discountPrice",value:s.discountPrice,onChange:p})]})]})}),e.jsxs(T,{item:!0,xs:12,md:6,sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs(h,{children:[e.jsxs("h3",{style:{fontSize:o?"16.5px":"20px",fontWeight:"bolder",textAlign:"justify"},children:["Images:",e.jsx("span",{style:{color:ye},children:"The first image will be the cover (maximum:6)"})]}),e.jsxs(h,{sx:{display:"flex",justifyContent:"flex-start",flexWrap:"wrap",gap:1.5},children:[e.jsx("input",{style:{border:"1p solid aqua",outline:"2px solid",outlineColor:je,textIndent:"4px"},type:"file",accept:"image/*",multiple:!0,onChange:ee}),e.jsx(D,{onClick:ae,variant:"contained",color:"success",size:o?"small":"large",disabled:z,fullWidth:!0,children:z?"Uploading....":"UPLOAD"})]})]}),e.jsxs(h,{className:"show image section",children:[e.jsx("p",{children:B&&B}),s.imageURLs.length>0&&s.imageURLs.map((a,t)=>e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx("img",{width:"100",height:"100",style:{borderRadius:"5px",objectFit:"cotain"},src:a,alt:a}),e.jsx(D,{onClick:()=>{Z(a)},variant:"text",color:"warning",children:"Delete"})]},t))]}),e.jsx(D,{sx:{},type:"submit",onClick:re,variant:"contained",fullWidth:!0,size:o?"small":"large",color:"success",disabled:!!z,children:z?"Loading":"Create list"})]})]})]})})};export{Ye as default};
