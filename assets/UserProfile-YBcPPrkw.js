function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/WaveHeader-BjF8U0ez.js","assets/index-B6Jh5Kqf.js","assets/index-DDnostVl.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{r as a,_ as Q,x as H,y as X,u as Y,b as Z,z as ee,j as e,F as se,J as te,B as m,T as x,I as ae,a as D,A as re,v as n,K as oe,E as ne,c as O,U as E,M as ie,O as le}from"./index-B6Jh5Kqf.js";import{g as ue,r as ce,u as de,a as me}from"./index.esm2017-C0yvW6Ps.js";import{a as pe}from"./firebase-ZV_pIUqm.js";import{C as fe}from"./ConfirmDialog-DcO7_sss.js";import{C as xe}from"./Container-Dhm7lGM3.js";import{G as v}from"./Grid-DmWEdVJA.js";import{T as g}from"./TextField-CLAyp7H7.js";import{I as ge}from"./InputAdornment-BjTQgN9C.js";import{V as he,a as be}from"./VisibilityOff-DxW5NHT4.js";import"./Zoom-BGt3lVFV.js";import"./styled-lc6bJm8w.js";import"./FormLabel-BWInThNm.js";import"./useFormControl-CrCWuu7o.js";import"./react-is.production.min-DUDD-a5e.js";import"./List-DmmOO-O2.js";const ye=a.lazy(()=>Q(()=>import("./WaveHeader-BjF8U0ez.js"),__vite__mapDeps([0,1,2]))),Fe=()=>{const h=H(),w=X(),F=Y(),c=Z(F.breakpoints.down("md")),r=ee(s=>s.persistData.user.userInfo),C=a.useRef(null),M=a.useRef(null),[t,S]=a.useState({...r,password:""}),[b,N]=a.useState(!1),[R,d]=a.useState(!1),[p,T]=a.useState(0),[U,W]=a.useState(""),[P,k]=a.useState(""),[B,A]=a.useState(!1),[y,_]=a.useState(null),L=()=>N(!b),f=s=>{const{name:i,value:l}=s.target;S(o=>({...o,[i]:i==="password"&&l===""?r.password:l}))},$=()=>C.current.click(),z=s=>{s.target.files[0]&&V(s.target.files[0])},V=s=>{const i=ue(pe),l=ce(i,`${Date.now()}-${s.name}`),o=de(l,s);M.current=o,o.on("state_changed",u=>{const j=u.bytesTransferred/u.totalBytes*100;T(j),d(!0)},u=>{W(u.message),d(!1),n.error(u.message)},async()=>{const u=await me(o.snapshot.ref);S(j=>({...j,avatar:u})),d(!1),n.success("Avatar uploaded successfully! Click update to save.")})},G=async()=>{if(y==="signOut")return I();if(y==="delete")return K()},I=()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("persist:root"),h(oe()),h(ne(!1)),w("/signin")},K=async()=>{try{(await O.delete(`${E}api/user/delete/${r.id}`)).data?(n.success("User deleted successfully"),I(),w("/signup")):n.error("Failed to delete user")}catch(s){n.error((s==null?void 0:s.message)||"Server error")}},q=async()=>{var i,l;if(!t.username||!t.email)return n.error("Username and email are required");if(!/^\d{10}$/.test(t.mobileNumber))return k("Mobile number should be 10 digits"),n.error("Mobile number should be 10 digits");if(r.username===t.username&&r.email===t.email&&r.avatar===t.avatar&&r.mobileNumber===t.mobileNumber&&(!t.password||t.password===r.password))return n.info("No changes detected");try{d(!0);const o=await O.put(`${E}api/user/update/${r.id}`,t);h(ie({...t,password:void 0})),n.success("Profile updated successfully"),T(0)}catch(o){n.error(((l=(i=o==null?void 0:o.response)==null?void 0:i.data)==null?void 0:l.message)||o.message)}finally{d(!1),k("")}},J=({value:s})=>e.jsxs(m,{sx:{position:"relative",display:"inline-flex"},children:[e.jsx(le,{variant:"determinate",value:s}),e.jsx(m,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(x,{variant:"caption",component:"div",color:"text.secondary",children:`${Math.round(s)}%`})})]});return e.jsxs(xe,{maxWidth:"lg",sx:{mt:4},children:[e.jsx(a.Suspense,{fallback:e.jsx(se,{}),children:e.jsx(ye,{title:"Profile"})}),e.jsx("input",{ref:C,type:"file",hidden:!0,accept:"image/*",onChange:z}),e.jsxs(v,{container:!0,spacing:4,alignItems:"flex-start",justifyContent:"center",sx:{mt:3},children:[e.jsxs(v,{item:!0,xs:12,sm:4,sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("img",{src:t.avatar||r.avatar||te,alt:r.username||"user image",onClick:$,style:{cursor:"pointer",width:150,height:150,borderRadius:"50%",objectFit:"cover",marginBottom:16,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",transition:"transform 0.2s"},onMouseOver:s=>s.currentTarget.style.transform="scale(1.05)",onMouseOut:s=>s.currentTarget.style.transform="scale(1)"}),e.jsxs(m,{sx:{width:"100%",textAlign:"center"},children:[p>0&&p<100&&e.jsxs(e.Fragment,{children:[e.jsx(x,{variant:"body2",sx:{mb:1},children:"Uploading..."}),e.jsx(J,{value:p})]}),p===100&&e.jsx(x,{color:"success.main",variant:"body2",children:"Upload complete! Press update."}),U&&e.jsx(x,{color:"error.main",variant:"body2",children:U})]})]}),e.jsx(v,{item:!0,xs:12,sm:8,children:e.jsxs(m,{sx:{display:"flex",flexDirection:"column",gap:2.5},children:[e.jsx(g,{label:"Username",name:"username",value:t.username,onChange:f,fullWidth:!0,size:c?"small":"medium",sx:{borderRadius:2,boxShadow:1}}),e.jsx(g,{label:"Email",name:"email",value:t.email,onChange:f,fullWidth:!0,size:c?"small":"medium",sx:{borderRadius:2,boxShadow:1}}),e.jsx(g,{label:"Password",name:"password",type:b?"text":"password",value:t.password,onChange:f,fullWidth:!0,size:c?"small":"medium",sx:{borderRadius:2,boxShadow:1},InputProps:{endAdornment:e.jsx(ge,{position:"end",children:e.jsx(ae,{onClick:L,children:b?e.jsx(he,{}):e.jsx(be,{})})})}}),e.jsx(g,{label:"Mobile Number",name:"mobileNumber",value:t.mobileNumber||"",onChange:f,error:!!P,helperText:P,fullWidth:!0,size:c?"small":"medium",sx:{borderRadius:2,boxShadow:1}}),e.jsx(D,{fullWidth:!0,size:c?"small":"large",variant:"contained",sx:{backgroundColor:re,borderRadius:2,"&:hover":{opacity:.9}},onClick:q,disabled:R,children:R?"Loading...":"UPDATE"}),e.jsx(m,{sx:{display:"flex",justifyContent:"space-around",width:"100%",mt:1},children:e.jsx(D,{color:"warning",variant:"outlined",sx:{borderRadius:2},onClick:()=>{_("signOut"),A(!0)},children:"Sign Out"})})]})})]}),e.jsx(fe,{open:B,onClose:()=>A(!1),title:"Warning",message:y==="signOut"?"Are you sure you want to sign out?":"Are you sure you want to delete your account?",cancelText:"Disagree",confirmText:"Agree",onConfirm:G})]})};export{Fe as default};
